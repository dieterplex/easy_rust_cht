<!DOCTYPE HTML>
<html lang="zh-TW" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title> æ¨™æº–å‡½å¼åº«ä¹‹æ—… - Easy Rust</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Chapter_0.html"><strong aria-hidden="true">1.</strong>  æ›´æ–°</a></li><li class="chapter-item expanded "><a href="Chapter_1.html"><strong aria-hidden="true">2.</strong>  ä»‹ç´¹</a></li><li class="chapter-item expanded "><a href="Chapter_2.html"><strong aria-hidden="true">3.</strong>  æˆ‘æ˜¯èª°ï¼Ÿ</a></li><li class="chapter-item expanded "><a href="Chapter_3.html"><strong aria-hidden="true">4.</strong>  ç°¡å–®è‹±èªå­¸ Rust</a></li><li class="chapter-item expanded "><a href="Chapter_4.html"><strong aria-hidden="true">5.</strong>  Rust Playground</a></li><li class="chapter-item expanded "><a href="Chapter_5.html"><strong aria-hidden="true">6.</strong>  ğŸš§ å’Œ âš ï¸</a></li><li class="chapter-item expanded "><a href="Chapter_6.html"><strong aria-hidden="true">7.</strong>  è¨»è§£</a></li><li class="chapter-item expanded "><a href="Chapter_7.html"><strong aria-hidden="true">8.</strong>  å‹åˆ¥</a></li><li class="chapter-item expanded "><a href="Chapter_8.html"><strong aria-hidden="true">9.</strong>  å‹åˆ¥æ¨å°</a></li><li class="chapter-item expanded "><a href="Chapter_9.html"><strong aria-hidden="true">10.</strong>  åˆ—å° hello, world!</a></li><li class="chapter-item expanded "><a href="Chapter_10.html"><strong aria-hidden="true">11.</strong>  é¡¯ç¤ºå’Œé™¤éŒ¯</a></li><li class="chapter-item expanded "><a href="Chapter_11.html"><strong aria-hidden="true">12.</strong>  å¯è®Šæ€§</a></li><li class="chapter-item expanded "><a href="Chapter_12.html"><strong aria-hidden="true">13.</strong>  å †ç–Šã€å †ç©å’ŒæŒ‡æ¨™</a></li><li class="chapter-item expanded "><a href="Chapter_13.html"><strong aria-hidden="true">14.</strong>  æ›´å¤šé—œæ–¼åˆ—å°</a></li><li class="chapter-item expanded "><a href="Chapter_14.html"><strong aria-hidden="true">15.</strong>  å­—ä¸²</a></li><li class="chapter-item expanded "><a href="Chapter_15.html"><strong aria-hidden="true">16.</strong>  const å’Œ static</a></li><li class="chapter-item expanded "><a href="Chapter_16.html"><strong aria-hidden="true">17.</strong>  æ›´å¤šé—œæ–¼åƒè€ƒ</a></li><li class="chapter-item expanded "><a href="Chapter_17.html"><strong aria-hidden="true">18.</strong>  å¯è®Šåƒè€ƒ</a></li><li class="chapter-item expanded "><a href="Chapter_18.html"><strong aria-hidden="true">19.</strong>  å‚³éåƒè€ƒçµ¦å‡½å¼</a></li><li class="chapter-item expanded "><a href="Chapter_19.html"><strong aria-hidden="true">20.</strong>  è¤‡è£½å‹åˆ¥</a></li><li class="chapter-item expanded "><a href="Chapter_20.html"><strong aria-hidden="true">21.</strong>  é›†åˆå‹åˆ¥</a></li><li class="chapter-item expanded "><a href="Chapter_21.html"><strong aria-hidden="true">22.</strong>  å‘é‡</a></li><li class="chapter-item expanded "><a href="Chapter_22.html"><strong aria-hidden="true">23.</strong>  å…ƒçµ„</a></li><li class="chapter-item expanded "><a href="Chapter_23.html"><strong aria-hidden="true">24.</strong>  æ§åˆ¶æµç¨‹</a></li><li class="chapter-item expanded "><a href="Chapter_24.html"><strong aria-hidden="true">25.</strong>  çµæ§‹é«”</a></li><li class="chapter-item expanded "><a href="Chapter_25.html"><strong aria-hidden="true">26.</strong>  åˆ—èˆ‰</a></li><li class="chapter-item expanded "><a href="Chapter_26.html"><strong aria-hidden="true">27.</strong>  è¿´åœˆ</a></li><li class="chapter-item expanded "><a href="Chapter_27.html"><strong aria-hidden="true">28.</strong>  å¯¦ä½œçµæ§‹é«”å’Œåˆ—èˆ‰</a></li><li class="chapter-item expanded "><a href="Chapter_28.html"><strong aria-hidden="true">29.</strong>  è§£æ§‹</a></li><li class="chapter-item expanded "><a href="Chapter_29.html"><strong aria-hidden="true">30.</strong>  åƒè€ƒå’Œé»é‹ç®—å­</a></li><li class="chapter-item expanded "><a href="Chapter_30.html"><strong aria-hidden="true">31.</strong>  æ³›å‹</a></li><li class="chapter-item expanded "><a href="Chapter_31.html"><strong aria-hidden="true">32.</strong>  Option å’Œ Result</a></li><li class="chapter-item expanded "><a href="Chapter_32.html"><strong aria-hidden="true">33.</strong>  å…¶ä»–é›†åˆå‹åˆ¥</a></li><li class="chapter-item expanded "><a href="Chapter_33.html"><strong aria-hidden="true">34.</strong>  å•è™Ÿ(?)é‹ç®—å­</a></li><li class="chapter-item expanded "><a href="Chapter_34.html"><strong aria-hidden="true">35.</strong>  ç‰¹å¾µ</a></li><li class="chapter-item expanded "><a href="Chapter_35.html"><strong aria-hidden="true">36.</strong>  éˆçµæ–¹æ³•</a></li><li class="chapter-item expanded "><a href="Chapter_36.html"><strong aria-hidden="true">37.</strong>  ç–Šä»£å™¨</a></li><li class="chapter-item expanded "><a href="Chapter_37.html"><strong aria-hidden="true">38.</strong>  é–‰åŒ…</a></li><li class="chapter-item expanded "><a href="Chapter_38.html"><strong aria-hidden="true">39.</strong>  dbg! å·¨é›†å’Œ .inspect</a></li><li class="chapter-item expanded "><a href="Chapter_39.html"><strong aria-hidden="true">40.</strong>  &str çš„ç¨®é¡</a></li><li class="chapter-item expanded "><a href="Chapter_40.html"><strong aria-hidden="true">41.</strong>  ç”Ÿå‘½é€±æœŸ</a></li><li class="chapter-item expanded "><a href="Chapter_41.html"><strong aria-hidden="true">42.</strong>  å…§éƒ¨å¯è®Šæ€§</a></li><li class="chapter-item expanded "><a href="Chapter_42.html"><strong aria-hidden="true">43.</strong>  Cow</a></li><li class="chapter-item expanded "><a href="Chapter_43.html"><strong aria-hidden="true">44.</strong>  é¡å‹åˆ¥å</a></li><li class="chapter-item expanded "><a href="Chapter_44.html"><strong aria-hidden="true">45.</strong>  todo! å·¨é›†</a></li><li class="chapter-item expanded "><a href="Chapter_45.html"><strong aria-hidden="true">46.</strong>  Rc</a></li><li class="chapter-item expanded "><a href="Chapter_46.html"><strong aria-hidden="true">47.</strong>  å¤šåŸ·è¡Œç·’</a></li><li class="chapter-item expanded "><a href="Chapter_47.html"><strong aria-hidden="true">48.</strong>  å‡½å¼ä¸­çš„é–‰åŒ…</a></li><li class="chapter-item expanded "><a href="Chapter_48.html"><strong aria-hidden="true">49.</strong>  impl ç‰¹å¾µ</a></li><li class="chapter-item expanded "><a href="Chapter_49.html"><strong aria-hidden="true">50.</strong>  Arc</a></li><li class="chapter-item expanded "><a href="Chapter_50.html"><strong aria-hidden="true">51.</strong>  é€šé“</a></li><li class="chapter-item expanded "><a href="Chapter_51.html"><strong aria-hidden="true">52.</strong>  é–±è®€ Rust æ–‡ä»¶</a></li><li class="chapter-item expanded "><a href="Chapter_52.html"><strong aria-hidden="true">53.</strong>  å±¬æ€§</a></li><li class="chapter-item expanded "><a href="Chapter_53.html"><strong aria-hidden="true">54.</strong>  Box</a></li><li class="chapter-item expanded "><a href="Chapter_54.html"><strong aria-hidden="true">55.</strong>  Box åŒ…è£¹çš„ç‰¹å¾µ</a></li><li class="chapter-item expanded "><a href="Chapter_55.html"><strong aria-hidden="true">56.</strong>  Default å’Œç”Ÿæˆå™¨æ¨¡å¼</a></li><li class="chapter-item expanded "><a href="Chapter_56.html"><strong aria-hidden="true">57.</strong>  Deref å’Œ DerefMut</a></li><li class="chapter-item expanded "><a href="Chapter_57.html"><strong aria-hidden="true">58.</strong>  Crates å’Œæ¨¡çµ„</a></li><li class="chapter-item expanded "><a href="Chapter_58.html"><strong aria-hidden="true">59.</strong>  æ¸¬è©¦</a></li><li class="chapter-item expanded "><a href="Chapter_59.html"><strong aria-hidden="true">60.</strong>  å¤–éƒ¨ crates</a></li><li class="chapter-item expanded "><a href="Chapter_60.html" class="active"><strong aria-hidden="true">61.</strong>  æ¨™æº–å‡½å¼åº«ä¹‹æ—…</a></li><li class="chapter-item expanded "><a href="Chapter_61.html"><strong aria-hidden="true">62.</strong>  æ’°å¯«å·¨é›†</a></li><li class="chapter-item expanded "><a href="Chapter_62.html"><strong aria-hidden="true">63.</strong>  cargo</a></li><li class="chapter-item expanded "><a href="Chapter_63.html"><strong aria-hidden="true">64.</strong>  æ¥å—ä½¿ç”¨è€…è¼¸å…¥</a></li><li class="chapter-item expanded "><a href="Chapter_64.html"><strong aria-hidden="true">65.</strong>  ä½¿ç”¨æª”æ¡ˆ</a></li><li class="chapter-item expanded "><a href="Chapter_65.html"><strong aria-hidden="true">66.</strong>  cargo doc å‘½ä»¤</a></li><li class="chapter-item expanded "><a href="Chapter_66.html"><strong aria-hidden="true">67.</strong>  çµæŸäº†å—ï¼Ÿ</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Easy Rust</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/dieterplex/easy_rust_cht" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/dieterplex/easy_rust_cht/edit/main/README.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h2 id="æ¨™æº–å‡½å¼åº«ä¹‹æ—…"><a class="header" href="#æ¨™æº–å‡½å¼åº«ä¹‹æ—…">æ¨™æº–å‡½å¼åº«ä¹‹æ—…</a></h2>
<p>ç¾åœ¨ä½ å·²ç¶“çŸ¥é“äº†å¾ˆå¤š Rust çš„çŸ¥è­˜ï¼Œä½ å°‡èƒ½å¤ ç†è§£æ¨™æº–å‡½å¼åº«è£¡é¢å¤§å¤šæ•¸çš„æ±è¥¿ã€‚å®ƒè£¡é¢çš„ç¨‹å¼ç¢¼å·²ç¶“ä¸å†é‚£éº¼å¯æ€•äº†ã€‚è®“æˆ‘å€‘ä¾†çœ‹çœ‹å®ƒè£¡é¢ä¸€äº›æˆ‘å€‘é‚„æ²’æœ‰å­¸éçš„éƒ¨åˆ†ã€‚é€™æ¬¡æ—…ç¨‹å°‡ä»‹ç´¹æ¨™æº–å‡½å¼åº«è£¡ä¸éœ€è¦å®‰è£ Rust çš„çµ•å¤§å¤šæ•¸éƒ¨åˆ†ã€‚æˆ‘å€‘å°‡é‡æº«å¾ˆå¤šæˆ‘å€‘å·²ç¶“çŸ¥é“çš„å…§å®¹ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥æ›´æ·±å…¥åœ°å­¸ç¿’å®ƒå€‘ã€‚</p>
<h3 id="é™£åˆ—"><a class="header" href="#é™£åˆ—">é™£åˆ—</a></h3>
<p>åœ¨éå»çš„ç‰ˆæœ¬ (Rust 1.53 ä»¥å‰) è£¡é™£åˆ— (Array) é‚„æ²’æœ‰å¯¦ä½œ <code>Iterator</code>ï¼Œä½ è¦åœ¨ <code>for</code> è¿´åœˆè£¡å°å®ƒå€‘ä½¿ç”¨åƒæ˜¯ <code>.iter()</code> çš„æ–¹æ³•ã€‚ï¼ˆäººå€‘ä»¥å‰ä¹Ÿå¸¸åœ¨ <code>for</code> è¿´åœˆè£¡ç”¨ <code>&amp;</code> ä¾†å¾—åˆ°åˆ‡ç‰‡ã€‚ï¼‰å› æ­¤é€™å€‹ç¯„ä¾‹åœ¨éå»æ˜¯ä¸èƒ½åŸ·è¡Œçš„ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_cities = [&quot;Beirut&quot;, &quot;Tel Aviv&quot;, &quot;Nicosia&quot;];

    for city in my_cities {
        println!(&quot;{}&quot;, city);
    }
}</code></pre></pre>
<p>ç·¨è­¯å™¨å¸¸å¸¸çµ¦å‡ºé€™æ®µè¨Šæ¯ï¼š</p>
<pre><code class="language-text">error[E0277]: `[&amp;str; 3]` is not an iterator
 --&gt; src\main.rs:5:17
  |
  |                 ^^^^^^^^^ borrow the array with `&amp;` or call `.iter()` on it to iterate over it
</code></pre>
<p>å¹¸é‹çš„æ˜¯é‚£ä¸å†æ˜¯å•é¡Œäº†ï¼æ‰€ä»¥é€™ä¸‰ç¨®ç”¨æ³•å…¨éƒ½èƒ½ç”¨ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_cities = [&quot;Beirut&quot;, &quot;Tel Aviv&quot;, &quot;Nicosia&quot;];

    for city in my_cities {
        println!(&quot;{}&quot;, city);
    }
    for city in &amp;my_cities {
        println!(&quot;{}&quot;, city);
    }
    for city in my_cities.iter() {
        println!(&quot;{}&quot;, city);
    }
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">Beirut
Tel Aviv
Nicosia
Beirut
Tel Aviv
Nicosia
Beirut
Tel Aviv
Nicosia
</code></pre>
<p>å¦‚æœä½ æƒ³å¾é™£åˆ—ä¸­å¾—åˆ°è®Šæ•¸ï¼Œä½ å¯ä»¥æŠŠå®ƒå€‘çš„è®Šæ•¸åæ”¾åœ¨ <code>[]</code> ä¸­ä¾†è§£æ§‹å®ƒã€‚é€™å’Œåœ¨ <code>match</code> é™³æ•˜å¼ä¸­ä½¿ç”¨å…ƒçµ„æˆ–å¾çµæ§‹é«”ä¸­å¾—åˆ°è®Šæ•¸æ˜¯ä¸€æ¨£çš„ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_cities = [&quot;Beirut&quot;, &quot;Tel Aviv&quot;, &quot;Nicosia&quot;];
    let [city1, city2, city3] = my_cities;
    println!(&quot;{}&quot;, city1);
}</code></pre></pre>
<p>å°å‡º <code>Beirut</code>ã€‚</p>
<h3 id="å­—å…ƒ"><a class="header" href="#å­—å…ƒ">å­—å…ƒ</a></h3>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>.escape_unicode()</code> æ–¹æ³•ä¾†å¾—åˆ°å­—å…ƒ (char) çš„ Unicode è™Ÿç¢¼ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let korean_word = &quot;ì²­ì¶˜ì˜ˆì°¬&quot;;
    for character in korean_word.chars() {
        print!(&quot;{} &quot;, character.escape_unicode());
    }
}</code></pre></pre>
<p>å°å‡º <code>\u{ccad} \u{cd98} \u{c608} \u{cc2c}</code>ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ <code>From</code> ç‰¹å¾µå¾ <code>u8</code> ä¸­å¾—åˆ°å­—å…ƒï¼Œä½†æ˜¯å¾ <code>u32</code> æ™‚ï¼Œä½ è¦ä½¿ç”¨ <code>TryFrom</code>ï¼Œå› ç‚ºå®ƒæœ‰å¯èƒ½ä¸æˆåŠŸã€‚<code>u32</code> å¯å®¹ç´çš„æ•¸å­—æ¯” Unicode ä¸­çš„å­—å…ƒå¤šå¾ˆå¤šã€‚æˆ‘å€‘å¯ä»¥é€éç°¡å–®çš„ç¤ºç¯„ä¾†è§€å¯Ÿåˆ°é€™ä»¶äº‹ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::convert::TryFrom; // ä½ éœ€è¦å¼•é€² TryFrom ä¾†ä½¿ç”¨å®ƒ
use rand::prelude::*;      // æˆ‘å€‘ä¹Ÿå°‡æœƒç”¨åˆ°éš¨æ©Ÿæ•¸

fn main() {
    let some_character = char::from(99); // é€™å€‹å®¹æ˜“ - ä¸éœ€è¦ TryFrom
    println!(&quot;{}&quot;, some_character);

    let mut random_generator = rand::thread_rng();
    // é€™å°‡æœƒå˜—è©¦ 40,000 æ¬¡ä¾†å¾ u32 åšå‡ºå­—å…ƒ.
    // ç¯„åœå¾ 0 (std::u32::MIN) åˆ° u32 çš„æœ€å¤§æ•¸å€¼ (std::u32::MAX). å¦‚æœå®ƒä¸æˆåŠŸ, æˆ‘å€‘æœƒçµ¦å®ƒ '-'.
    for _ in 0..40_000 {
        let bigger_character = char::try_from(random_generator.gen_range(std::u32::MIN..std::u32::MAX)).unwrap_or('-');
        print!(&quot;{}&quot;, bigger_character)
    }
}</code></pre></pre>
<p>å¹¾ä¹æ¯æ¬¡éƒ½æœƒç”¢ç”Ÿ <code>-</code>ã€‚é€™æ˜¯ä½ æœƒçœ‹åˆ°çš„é‚£ç¨®è¼¸å‡ºçš„ä¸€éƒ¨åˆ†ï¼š</p>
<pre><code class="language-text">------------------------------------------------------------------------ğ¤’°---------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-------------------------------------------------------------ì¶—--------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------------
------------ò‡œ----------------------------------------------------
</code></pre>
<p>æ‰€ä»¥ä½ éœ€è¦ä½¿ç”¨ <code>TryFrom</code> å…¶å¯¦æ˜¯ä»¶å¥½äº‹ã€‚</p>
<p>å¦å¤–ï¼Œå¾ 2020 å¹´å…«æœˆåº•é–‹å§‹ï¼Œä½ ç¾åœ¨å¯ä»¥å¾ <code>char</code> ä¸­å¾—åˆ° <code>String</code>ã€‚(<code>String</code> å¯¦ä½œäº† <code>From&lt;char&gt;</code>) åªè¦å¯« <code>String::from()</code>ï¼Œç„¶å¾ŒæŠŠ <code>char</code> æ”¾åœ¨è£¡é¢ã€‚</p>
<h3 id="æ•´æ•¸"><a class="header" href="#æ•´æ•¸">æ•´æ•¸</a></h3>
<p>çµ¦é€™äº›æ•´æ•¸å‹åˆ¥ç”¨çš„æ•¸å­¸æ–¹æ³•æœ‰å¾ˆå¤šï¼Œå†åŠ ä¸Šä¸€äº›å…¶ä»–ç”¨é€”çš„æ–¹æ³•ã€‚é€™è£¡æ˜¯ä¸€äº›æœ€æœ‰ç”¨çš„ï¼š</p>
<p><code>.checked_add()</code>ã€<code>.checked_sub()</code>ã€<code>.checked_mul()</code>ã€<code>.checked_div()</code>ã€‚å¦‚æœä½ èªç‚ºä½ å¯èƒ½æœƒå¾—åˆ°ä¸€å€‹ä¸é©åˆå‹åˆ¥çš„æ•¸å­—ï¼Œé€™äº›éƒ½æ˜¯ä¸éŒ¯çš„æ–¹æ³•ã€‚å®ƒå€‘æœƒå›å‚³ <code>Option</code>ï¼Œé€™æ¨£ä½ å°±å¯ä»¥å®‰å…¨åœ°æª¢æŸ¥ä½ çš„æ•¸å­¸é‹ç®—æ˜¯å¦æ­£å¸¸ï¼Œè€Œä¸æœƒè®“ç¨‹å¼ææ…Œã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let some_number = 200_u8;
    let other_number = 200_u8;

    println!(&quot;{:?}&quot;, some_number.checked_add(other_number));
    println!(&quot;{:?}&quot;, some_number.checked_add(1));
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">None
Some(201)
</code></pre>
<p>ä½ æœƒæ³¨æ„åˆ°ï¼Œåœ¨æ•´æ•¸çš„é é¢ä¸Šç¶“å¸¸èªªè‘— <code>rhs</code>ã€‚é€™æ„å‘³è‘—&quot;å³æ‰‹é‚Š(right hand side)&quot;ï¼Œä¹Ÿå°±æ˜¯ä½ åšä¸€äº›æ•¸å­¸é‹ç®—æ™‚å³æ‰‹é‚Šçš„é‹ç®—å…ƒã€‚æ¯”å¦‚åœ¨ <code>5 + 6</code> ä¸­ï¼Œ<code>5</code> åœ¨å·¦ã€<code>6</code> åœ¨å³ï¼Œæ‰€ä»¥ <code>6</code> å°±æ˜¯ <code>rhs</code>ã€‚é€™å€‹ä¸æ˜¯é—œéµè©ï¼Œä½†æ˜¯ä½ æœƒç¶“å¸¸çœ‹åˆ°ï¼Œæ‰€ä»¥å…ˆçŸ¥é“æ¯”è¼ƒå¥½ã€‚</p>
<p>èªªåˆ°é€™è£¡ï¼Œæˆ‘å€‘ä¾†å­¸ç¿’ä¸€ä¸‹å¦‚ä½•å¯¦ä½œ <code>Add</code>ã€‚åœ¨ä½ å¯¦ä½œäº† <code>Add</code> ä¹‹å¾Œï¼Œä½ å¯ä»¥åœ¨ä½ å»ºç«‹çš„å‹åˆ¥ä¸Šä½¿ç”¨ <code>+</code>ã€‚ä½ éœ€è¦è‡ªå·±å¯¦ä½œ <code>Add</code>ï¼Œå› ç‚º add å¯ä»¥è¡¨é”å¾ˆå¤šæ„æ€ã€‚é€™æ˜¯æ¨™æº–å‡½å¼åº«é é¢ä¸­çš„ç¯„ä¾‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::ops::Add; // é¦–å…ˆå¼•é€² Add

#[derive(Debug, Copy, Clone, PartialEq)] // PartialEq å¤§æ¦‚æ˜¯é€™è£¡æœ€é‡è¦çš„éƒ¨ä»½äº†. ä½ æœƒæƒ³è¦è®“æ•¸å­—èƒ½æ¯”è¼ƒ
struct Point {
    x: i32,
    y: i32,
}

impl Add for Point {
    type Output = Self; // è¨˜å¾—å—, é€™å«åš&quot;é—œè¯å‹åˆ¥&quot;: &quot;ä¸€èµ·å‡ºç¾çš„å‹åˆ¥&quot;.
                        // é€™å€‹æƒ…æ³ä¸‹é€™ä¸éæ˜¯å¦ä¸€å€‹ Point

    fn add(self, other: Self) -&gt; Self {
        Self {
            x: self.x + other.x,
            y: self.y + other.y,
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<p>ç¾åœ¨è®“æˆ‘å€‘ç‚ºè‡ªå·±çš„å‹åˆ¥å¯¦ä½œ <code>Add</code>ã€‚è®“æˆ‘å€‘æƒ³åƒæˆ‘å€‘æƒ³æŠŠå…©å€‹åœ‹å®¶åŠ åœ¨ä¸€èµ·ï¼Œé€™æ¨£æˆ‘å€‘å°±å¯ä»¥æ¯”è¼ƒå®ƒå€‘çš„ç¶“æ¿Ÿã€‚é‚£çœ‹èµ·ä¾†åƒé€™æ¨£ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::fmt;
use std::ops::Add;

#[derive(Clone)]
struct Country {
    name: String,
    population: u32,
    gdp: u32, // é€™æ˜¯ç¶“æ¿Ÿå¤§å°
}

impl Country {
    fn new(name: &amp;str, population: u32, gdp: u32) -&gt; Self {
        Self {
            name: name.to_string(),
            population,
            gdp,
        }
    }
}

impl Add for Country {
    type Output = Self;

    fn add(self, other: Self) -&gt; Self {
        Self {
            name: format!(&quot;{} and {}&quot;, self.name, other.name), // æˆ‘å€‘æœƒä¸€èµ·åŠ ä¸Šåç¨±,
            population: self.population + other.population, // ä»¥åŠäººå£æ•¸,
            gdp: self.gdp + other.gdp,   // å’Œ GDP
        }
    }
}

impl fmt::Display for Country {
    fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;'_&gt;) -&gt; fmt::Result {
        write!(
            f,
            &quot;In {} are {} people and a GDP of ${}&quot;, // ç„¶å¾Œæˆ‘å€‘å¯ä»¥åªç”¨ {} æŠŠå®ƒå€‘å…¨éƒ¨å°å‡ºä¾†
            self.name, self.population, self.gdp
        )
    }
}

fn main() {
    let nauru = Country::new(&quot;Nauru&quot;, 10_670, 160_000_000);
    let vanuatu = Country::new(&quot;Vanuatu&quot;, 307_815, 820_000_000);
    let micronesia = Country::new(&quot;Micronesia&quot;, 104_468, 367_000_000);

    // æˆ‘å€‘å¯ä»¥çµ¦äºˆ Country çš„ name æ˜¯å€‹ &amp;str è€Œä¸æ˜¯ String. ä½†æ˜¯æˆ‘å€‘å°±éœ€è¦åˆ°è™•å¯«ä¸Šç”Ÿå‘½é€±æœŸ
    // ä¸¦ä¸”é‚£æ¨£å°å°ç¯„ä¾‹ä¾†èªªå°±å¤ªå¤šæ±è¥¿äº†. æ¯”è¼ƒå¥½çš„æ–¹å¼æ˜¯åªåœ¨æˆ‘å€‘å‘¼å« println! æ™‚å…‹éš†å®ƒå€‘.
    println!(&quot;{}&quot;, nauru.clone());
    println!(&quot;{}&quot;, nauru.clone() + vanuatu.clone());
    println!(&quot;{}&quot;, nauru + vanuatu + micronesia);
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">In Nauru are 10670 people and a GDP of $160000000
In Nauru and Vanuatu are 318485 people and a GDP of $980000000
In Nauru and Vanuatu and Micronesia are 422953 people and a GDP of $1347000000
</code></pre>
<p>ä»¥å¾Œåœ¨é€™æ®µç¨‹å¼ç¢¼ä¸­ï¼Œæˆ‘å€‘å¯ä»¥æŠŠ <code>.fmt()</code> æ”¹ç‚ºé¡¯ç¤ºæ›´å®¹æ˜“é–±è®€çš„æ•¸å­—ã€‚</p>
<p>å¦å¤–ä¸‰å€‹å« <code>Sub</code>ã€<code>Mul</code> å’Œ <code>Div</code>ï¼Œå¯¦ä½œèµ·ä¾†åŸºæœ¬ä¸€æ¨£ã€‚<code>+=</code>ã€<code>-=</code>ã€<code>*=</code> å’Œ <code>/=</code>ï¼Œåªè¦åŠ ä¸Š <code>Assign</code>ï¼š<code>AddAssign</code>ã€<code>SubAssign</code>ã€<code>MulAssign</code> å’Œ <code>DivAssign</code> å³å¯ã€‚ä½ å¯ä»¥åœ¨<a href="https://doc.rust-lang.org/std/ops/index.html#structs">é€™è£¡</a>çœ‹åˆ°å®Œæ•´çš„åˆ—è¡¨ï¼Œå› ç‚ºé‚„æœ‰å¾ˆå¤šã€‚ä¾‹å¦‚ <code>%</code> è¢«ç¨±ç‚º <code>Rem</code>ï¼Œ<code>-</code> è¢«ç¨±ç‚º <code>Neg</code>ï¼Œç­‰ç­‰ã€‚</p>
<h3 id="æµ®é»æ•¸"><a class="header" href="#æµ®é»æ•¸">æµ®é»æ•¸</a></h3>
<p><code>f32</code> å’Œ <code>f64</code> æœ‰éå¸¸å¤§é‡çš„æ–¹æ³•è®“ä½ åœ¨åšæ•¸å­¸é‹ç®—æ™‚ä½¿ç”¨ã€‚æˆ‘å€‘ä¸æœƒå»çœ‹é€™äº›æ±è¥¿ï¼Œä½†é€™è£¡æœ‰ä¸€äº›ä½ å¯èƒ½æœƒç”¨åˆ°çš„æ–¹æ³•ã€‚å®ƒå€‘åˆ†åˆ¥æ˜¯ <code>.floor()</code>ã€<code>.ceil()</code>ã€<code>.round()</code> å’Œ <code>.trunc()</code>ã€‚æ‰€æœ‰é€™äº›æ–¹æ³•éƒ½æœƒå›å‚³åƒæ•´æ•¸çš„ <code>f32</code> æˆ–è€… <code>f64</code>ï¼Œä½†å°æ•¸é»å¾Œé¢æ˜¯ <code>0</code>ã€‚å®ƒå€‘æ˜¯é€™æ¨£åšçš„ï¼š</p>
<ul>
<li><code>.floor()</code>ï¼šçµ¦ä½ ä¸‹ä¸€å€‹æœ€ä½çš„æ•´æ•¸ã€‚</li>
<li><code>.ceil()</code>ï¼šçµ¦ä½ ä¸‹ä¸€å€‹æœ€é«˜çš„æ•´æ•¸ã€‚</li>
<li><code>.round()</code>ï¼šçµ¦ä½ è¼ƒå¤§çš„æ•´æ•¸ï¼Œå¦‚æœå°æ•¸å¤§æ–¼ç­‰æ–¼ 0.5ï¼›æˆ–æ˜¯ç›¸åŒçš„æ•´æ•¸ï¼Œå¦‚æœå°æ•¸å°æ–¼ 0.5ã€‚é€™å°±æ˜¯æ‰€è¬‚çš„å››æ¨äº”å…¥ï¼Œå› ç‚ºå®ƒçµ¦ä½ &quot;æ¨å»æˆ–é€²ä½(round)&quot;çš„æ•¸å­—(æ•¸å­—çš„ç²¾ç°¡å½¢å¼)ã€‚</li>
<li><code>.trunc()</code>ï¼šåªæ˜¯åˆ‡é™¤æ‰å°æ•¸é»è™Ÿå¾Œçš„éƒ¨åˆ†ã€‚æˆªæ–·(Truncate)æ˜¯&quot;åˆ‡é™¤&quot;çš„æ„æ€ã€‚</li>
</ul>
<p>é€™è£¡æ˜¯å€‹ç°¡å–®çš„å‡½å¼ä¾†å°å‡ºå®ƒå€‘ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn four_operations(input: f64) {
    println!(
&quot;For the number {}:
floor: {}
ceiling: {}
rounded: {}
truncated: {}\n&quot;,
        input,
        input.floor(),
        input.ceil(),
        input.round(),
        input.trunc()
    );
}

fn main() {
    four_operations(9.1);
    four_operations(100.7);
    four_operations(-1.1);
    four_operations(-19.9);
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">For the number 9.1:
floor: 9
ceiling: 10
rounded: 9 // because less than 9.5
truncated: 9

For the number 100.7:
floor: 100
ceiling: 101
rounded: 101 // because more than 100.5
truncated: 100

For the number -1.1:
floor: -2
ceiling: -1
rounded: -1
truncated: -1

For the number -19.9:
floor: -20
ceiling: -19
rounded: -20
truncated: -19
</code></pre>
<p><code>f32</code> å’Œ <code>f64</code> æœ‰æ–¹æ³•å«åš <code>.max()</code> å’Œ <code>.min()</code>ï¼Œå¯ä»¥å¾—åˆ°å…©å€‹æ•¸å­—ä¸­è¼ƒå¤§æˆ–è¼ƒå°çš„æ•¸å­—ã€‚(å°æ–¼å…¶ä»–å‹åˆ¥ï¼Œä½ å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>std::cmp::max</code> å’Œ <code>std::cmp::min</code>ã€‚)é€™è£¡çš„ç¯„ä¾‹æ˜¯ç”¨ <code>.fold()</code> ä¾†å¾—åˆ°æœ€é«˜æˆ–æœ€ä½æ•¸å­—çš„æ–¹æ³•ã€‚ä½ å¯ä»¥å†æ¬¡çœ‹åˆ° <code>.fold()</code> ä¸åƒ…åƒ…æ˜¯ç”¨ä¾†åŠ æ•¸å­—çš„ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let my_vec = vec![8.0_f64, 7.6, 9.4, 10.0, 22.0, 77.345, 10.22, 3.2, -7.77, -10.0];
    let maximum = my_vec.iter().fold(f64::MIN, |current_number, next_number| current_number.max(*next_number)); // è¨»: å¾ f64 çš„æœ€ä½å¯èƒ½çš„æ•¸å­—é–‹å§‹.
    let minimum = my_vec.iter().fold(f64::MAX, |current_number, next_number| current_number.min(*next_number)); // è€Œé€™è£¡å‰‡å¾æœ€é«˜å¯èƒ½çš„æ•¸å­—é–‹å§‹
    println!(&quot;{}, {}&quot;, maximum, minimum);
}</code></pre></pre>
<h3 id="å¸ƒæ—"><a class="header" href="#å¸ƒæ—">å¸ƒæ—</a></h3>
<p>åœ¨ Rust ä¸­ï¼Œå¦‚æœä½ é¡˜æ„ï¼Œä½ å¯ä»¥æŠŠ <code>bool</code> è®Šæˆæ•´æ•¸ï¼Œå› ç‚ºé€™æ¨£åšæ˜¯å®‰å…¨çš„ã€‚ä½†ä½ ä¸èƒ½åéä¾†åšã€‚å¦‚ä½ æ‰€è¦‹ï¼Œ<code>true</code> è®Šæˆäº† 1ï¼Œ<code>false</code> è®Šæˆäº† 0ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let true_false = (true, false);
    println!(&quot;{} {}&quot;, true_false.0 as u8, true_false.1 as i32);
}</code></pre></pre>
<p>å°å‡º <code>1 0</code>ã€‚æˆ–è€…æ˜¯å¦‚æœä½ å‘Šè¨´ç·¨è­¯å™¨å‹åˆ¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.into()</code>ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let true_false: (i128, u16) = (true.into(), false.into());
    println!(&quot;{} {}&quot;, true_false.0, true_false.1);
}</code></pre></pre>
<p>å°å‡ºçš„æ˜¯ä¸€æ¨£çš„æ±è¥¿ã€‚</p>
<p>å¾ Rust 1.50 (2021 å¹´ 2 æœˆé‡‹å‡º)é–‹å§‹ï¼Œæœ‰å€‹å«åš <code>then()</code> çš„æ–¹æ³•ï¼Œå®ƒå°‡ <code>bool</code> è®Šæˆ <code>Option</code>ã€‚ä½¿ç”¨ <code>then()</code> æ™‚éœ€è¦æ¥å—é–‰åŒ…ï¼Œå¦‚æœå…ƒç´ æ˜¯<code>true</code>ï¼Œé–‰åŒ…å°±æœƒè¢«å‘¼å«ã€‚å¦å¤–ï¼Œç„¡è«–å¾é–‰åŒ…ä¸­å›å‚³ä»€éº¼ï¼Œéƒ½æœƒæ”¾å…¥ <code>Option</code> è£¡ã€‚é€™è£¡æ˜¯å€‹å°ç¯„ä¾‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {

    let (tru, fals) = (true.then(|| 8), false.then(|| 8));
    println!(&quot;{:?}, {:?}&quot;, tru, fals);
}</code></pre></pre>
<p>åªæ˜¯å°å‡º <code>Some(8), None</code>ã€‚</p>
<p>è€Œç¾åœ¨æ˜¯å€‹é•·ä¸€é»çš„ç¯„ä¾‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let bool_vec = vec![true, false, true, false, false];
    
    let option_vec = bool_vec
        .iter()
        .map(|item| {
            item.then(|| { // æŠŠé€™å€‹æ”¾åœ¨ map è£¡é¢é‚£æˆ‘å€‘æ‰å¯ä»¥æŠŠå®ƒå‚³ä¸‹å»
                println!(&quot;Got a {}!&quot;, item);
                &quot;It's true, you know&quot; // å¦‚æœæ˜¯ true å°±æŠŠé€™å€‹æ”¾é€² Some è£¡
                                      // ä¸ç„¶å°±åªå‚³ None ä¸‹å»
            })
        })
        .collect::&lt;Vec&lt;_&gt;&gt;();

    println!(&quot;Now we have: {:?}&quot;, option_vec);

    // é‚£ä¹Ÿæœƒå°å‡º Nones. è®“æˆ‘å€‘å¾ map éæ¿¾å®ƒå€‘åˆ°æ–°çš„å‘é‡è£¡.
    let filtered_vec = option_vec.into_iter().filter_map(|c| c).collect::&lt;Vec&lt;_&gt;&gt;();

    println!(&quot;And without the Nones: {:?}&quot;, filtered_vec);
}</code></pre></pre>
<p>é€™è£¡æ˜¯å°å‡ºçš„å…§å®¹ï¼š</p>
<pre><code class="language-text">Got a true!
Got a true!
Now we have: [Some(&quot;It\'s true, you know&quot;), None, Some(&quot;It\'s true, you know&quot;), None, None]
And without the Nones: [&quot;It\'s true, you know&quot;, &quot;It\'s true, you know&quot;]
</code></pre>
<h3 id="å‘é‡"><a class="header" href="#å‘é‡">å‘é‡</a></h3>
<p>Vecï¼ˆå‘é‡ï¼‰æœ‰å¾ˆå¤šæ–¹æ³•æˆ‘å€‘é‚„æ²’æœ‰çœ‹éã€‚å…ˆä¾†èªªèªª <code>.sort()</code>ã€‚<code>.sort()</code> ä¸€é»éƒ½ä¸æ„å¤–ï¼Œä½¿ç”¨äº† <code>&amp;mut self</code> ä¾†å°å‘é‡é€²è¡Œæ’åºã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_vec = vec![100, 90, 80, 0, 0, 0, 0, 0];
    my_vec.sort();
    println!(&quot;{:?}&quot;, my_vec);
}</code></pre></pre>
<p>å°å‡º <code>[0, 0, 0, 0, 0, 80, 90, 100]</code>ã€‚ä½†é‚„æœ‰ä¸€ç¨®æ›´æœ‰è¶£çš„æ’åºæ–¹å¼å« <code>.sort_unstable()</code>ï¼Œå®ƒé€šå¸¸æ›´å¿«ã€‚å®ƒä¹‹æ‰€ä»¥æ›´å¿«ï¼Œæ˜¯å› ç‚ºå®ƒä¸åœ¨ä¹æ’åºå‰å¾Œç›¸åŒæ•¸å­—çš„å…ˆå¾Œé †åºã€‚åœ¨å¸¸è¦çš„ <code>.sort()</code> ä¸­ï¼Œä½ çŸ¥é“æœ€å¾Œçš„ <code>0, 0, 0, 0, 0</code> æœƒåœ¨ <code>.sort()</code> ä¹‹å¾Œçš„é †åºç›¸åŒã€‚ä½†æ˜¯ <code>.sort_unstable()</code> å¯èƒ½æœƒæŠŠæœ€å¾Œä¸€å€‹é›¶ç§»åˆ°ç´¢å¼• 0ï¼Œç„¶å¾ŒæŠŠå€’æ•¸ç¬¬ä¸‰å€‹é›¶ç§»åˆ°ç´¢å¼• 2ï¼Œç­‰ç­‰ã€‚</p>
<p><code>.dedup()</code> çš„æ„æ€æ˜¯&quot;å»é‡è¤‡&quot;(de-duplicate)ã€‚å®ƒå°‡åˆªé™¤å‘é‡ä¸­ç›¸åŒçš„å…ƒç´ ï¼Œä½†åªæœ‰ç•¶å®ƒå€‘å½¼æ­¤ç›¸é„°æ™‚æ‰æœƒåˆªé™¤ã€‚æ¥ä¸‹ä¾†é€™æ®µç¨‹å¼ç¢¼ä¸æœƒåªå°å‡º <code>&quot;sun&quot;, &quot;moon&quot;</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_vec = vec![&quot;sun&quot;, &quot;sun&quot;, &quot;moon&quot;, &quot;moon&quot;, &quot;sun&quot;, &quot;moon&quot;, &quot;moon&quot;];
    my_vec.dedup();
    println!(&quot;{:?}&quot;, my_vec);
}</code></pre></pre>
<p>å®ƒåªæ˜¯æŠŠ &quot;sun&quot; æ—é‚Šçš„å¦ä¸€å€‹ &quot;sun&quot; å»æ‰ï¼Œç„¶å¾ŒæŠŠ &quot;moon&quot; æ—é‚Šçš„ä¸‹ä¸€å€‹ &quot;moon&quot; å»æ‰ï¼Œå†æŠŠ &quot;moon&quot; æ—é‚Šçš„å¦ä¸€å€‹ &quot;moon&quot; å»æ‰ã€‚çµæœæ˜¯ <code>[&quot;sun&quot;, &quot;moon&quot;, &quot;sun&quot;, &quot;moon&quot;]</code>ã€‚</p>
<p>å¦‚æœä½ æƒ³æŠŠæ¯å€‹é‡è¤‡çš„éƒ½å»æ‰ï¼Œå°±å…ˆ <code>.sort()</code>ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_vec = vec![&quot;sun&quot;, &quot;sun&quot;, &quot;moon&quot;, &quot;moon&quot;, &quot;sun&quot;, &quot;moon&quot;, &quot;moon&quot;];
    my_vec.sort();
    my_vec.dedup();
    println!(&quot;{:?}&quot;, my_vec);
}</code></pre></pre>
<p>çµæœï¼š<code>[&quot;moon&quot;, &quot;sun&quot;]</code>ã€‚</p>
<h3 id="å­—ä¸²"><a class="header" href="#å­—ä¸²">å­—ä¸²</a></h3>
<p>ä½ æœƒè¨˜å¾— <code>String</code> æœ‰é»åƒæ˜¯ä¸€ç¨® <code>Vec</code>ã€‚å®ƒå¾ˆåƒ <code>Vec</code> è®“ä½ å¯ä»¥å‘¼å«å¾ˆå¤šç›¸åŒçš„æ–¹æ³•ã€‚æ¯”å¦‚èªªï¼Œä½ å¯ä»¥ç”¨ <code>String::with_capacity()</code> å»ºç«‹å­—ä¸²ï¼Œå°¤å…¶æ˜¯å¦‚æœä½ æœƒéœ€è¦ä¸€ç›´ç”¨ <code>.push()</code> æ¨é€² <code>char</code> å¤šæ¬¡ï¼Œæˆ–è€…ç”¨ <code>.push_str()</code> æ¨é€² <code>&amp;str</code>ã€‚é€™è£¡æ˜¯å€‹å° <code>String</code> æœ‰å¤ªå¤šæ¬¡è¨˜æ†¶é«”åˆ†é… (allocation) çš„ç¯„ä¾‹ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut push_string = String::new();
    let mut capacity_counter = 0; // å®¹é‡å¾ 0 é–‹å§‹
    for _ in 0..100_000 { // åš 100,000 æ¬¡
        if push_string.capacity() != capacity_counter { // é¦–å…ˆæª¢æŸ¥å®¹é‡ç¾åœ¨æ˜¯å¦ä¸åŒ
            println!(&quot;{}&quot;, push_string.capacity()); // å¦‚æœæ˜¯å°±å°å‡ºä¾†
            capacity_counter = push_string.capacity(); // å†ä¾†æ›´æ–°è¨ˆæ•¸å™¨
        }
        push_string.push_str(&quot;I'm getting pushed into the string!&quot;); // ä¸¦ä¸”æ¯æ¬¡æ¨é€™å€‹å­—ä¸²é€²å»
    }
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">35
70
140
280
560
1120
2240
4480
8960
17920
35840
71680
143360
286720
573440
1146880
2293760
4587520
</code></pre>
<p>æˆ‘å€‘ä¸å¾—ä¸é‡åˆ†é…(reallocateï¼ŒæŠŠæ‰€æœ‰æ±è¥¿è¤‡è£½éä¾†åˆ°å¦ä¸€è™•è¨˜æ†¶é«”ä½ç½®) 18æ¬¡ã€‚ä½†æ—¢ç„¶æˆ‘å€‘çŸ¥é“äº†æœ€çµ‚çš„å®¹é‡(capacity)ï¼Œé‚£éº¼æˆ‘å€‘å°‡é¦¬ä¸Šçµ¦å®ƒå®¹é‡ï¼Œå°±ä¸éœ€è¦é‡åˆ†é…ï¼šåªè¦ä¸€å€‹ <code>String</code> å®¹é‡å€¼å°±å¤ äº†ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut push_string = String::with_capacity(4587520); // æˆ‘å€‘çŸ¥é“æ˜ç¢ºçš„æ•¸å­—. ä¸€äº›ä¸åŒçš„å¤§æ•¸å­—ä¹Ÿè¡Œå¾—é€š
    let mut capacity_counter = 0;
    for _ in 0..100_000 {
        if push_string.capacity() != capacity_counter {
            println!(&quot;{}&quot;, push_string.capacity());
            capacity_counter = push_string.capacity();
        }
        push_string.push_str(&quot;I'm getting pushed into the string!&quot;);
    }
}</code></pre></pre>
<p>å°å‡º <code>4587520</code>ã€‚å®Œç¾ï¼æˆ‘å€‘æ°¸é ä¸å†éœ€è¦åˆ†é…äº†ã€‚</p>
<p>ç•¶ç„¶å¯¦éš›é•·åº¦è‚¯å®šæ¯”é€™å€‹å°ã€‚å¦‚æœä½ è©¦äº† 100001 æ¬¡ã€101000 æ¬¡ç­‰ç­‰ï¼Œé‚„æ˜¯æœƒèªª <code>4587520</code>ã€‚é€™æ˜¯å› ç‚ºæ¯æ¬¡çš„å®¹é‡éƒ½æ˜¯ä¹‹å‰çš„å…©å€ã€‚ä¸éæˆ‘å€‘å¯ä»¥ç”¨ <code>.shrink_to_fit()</code> ä¾†ç¸®å°å®ƒ(å’Œ <code>Vec</code> ä¸€æ¨£)ã€‚æˆ‘å€‘çš„ <code>String</code> å·²ç¶“éå¸¸å¤§äº†ï¼Œæˆ‘å€‘ä¸æƒ³å†çµ¦å®ƒå¢åŠ ä»»ä½•æ±è¥¿ï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥æŠŠå®ƒç¸®å°ä¸€é»ã€‚ä½†æ˜¯åªæœ‰åœ¨ä½ æœ‰æŠŠæ¡çš„æƒ…æ³ä¸‹æ‰å¯ä»¥é€™æ¨£åšã€‚é€™è£¡æ˜¯åŸå› ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut push_string = String::with_capacity(4587520);
    let mut capacity_counter = 0;
    for _ in 0..100_000 {
        if push_string.capacity() != capacity_counter {
            println!(&quot;{}&quot;, push_string.capacity());
            capacity_counter = push_string.capacity();
        }
        push_string.push_str(&quot;I'm getting pushed into the string!&quot;);
    }
    push_string.shrink_to_fit();
    println!(&quot;{}&quot;, push_string.capacity());
    push_string.push('a');
    println!(&quot;{}&quot;, push_string.capacity());
    push_string.shrink_to_fit();
    println!(&quot;{}&quot;, push_string.capacity());
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">4587520
3500000
7000000
3500001
</code></pre>
<p>æ‰€ä»¥é¦–å…ˆæˆ‘å€‘çš„å¤§å°æ˜¯ <code>4587520</code>ï¼Œä½†æˆ‘å€‘æ²’æœ‰å…¨éƒ¨ä½¿ç”¨åˆ°ã€‚æˆ‘å€‘ç”¨äº† <code>.shrink_to_fit()</code>ï¼Œç„¶å¾ŒæŠŠå¤§å°é™åˆ°äº† <code>3500000</code>ã€‚ä½†æ˜¯æˆ‘å€‘å¿˜è¨˜äº†éœ€è¦æ¨ä¸Š <code>a</code>ã€‚ç•¶æˆ‘å€‘é€™æ¨£åšçš„æ™‚å€™ï¼ŒRust çœ‹åˆ°æˆ‘å€‘éœ€è¦æ›´å¤šçš„ç©ºé–“ï¼Œä¸¦åŠ å€çµ¦äº†æˆ‘å€‘ï¼šç¾åœ¨æ˜¯ <code>7000000</code>ã€‚å“å‘€ï¼æ‰€ä»¥æˆ‘å€‘åˆå‘¼å«äº† <code>.shrink_to_fit()</code> ä¸€æ¬¡ï¼Œç¾åœ¨åˆå›åˆ°äº† <code>3500001</code>ã€‚</p>
<p><code>.pop()</code> èƒ½ç”¨åœ¨ <code>String</code>ï¼Œå°±åƒç”¨åœ¨ <code>Vec</code> ä¸€æ¨£ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_string = String::from(&quot;.daer ot drah tib elttil a si gnirts sihT&quot;);
    loop {
        let pop_result = my_string.pop();
        match pop_result {
            Some(character) =&gt; print!(&quot;{}&quot;, character),
            None =&gt; break,
        }
    }
}</code></pre></pre>
<p>å°å‡º <code>This string is a little bit hard to read.</code> å› ç‚ºå®ƒå¾æœ€å¾Œä¸€å€‹å­—å…ƒé–‹å§‹ã€‚</p>
<p><code>.retain()</code> æ˜¯ä½¿ç”¨é–‰åŒ…çš„æ–¹æ³•ï¼Œé€™å° <code>String</code> ä¾†èªªå¾ˆå°‘è¦‹ã€‚å°±åƒåœ¨ç–Šä»£å™¨ä¸Šçš„ <code>.filter()</code> ä¸€æ¨£ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut my_string = String::from(&quot;Age: 20 Height: 194 Weight: 80&quot;);
    my_string.retain(|character| character.is_alphabetic() || character == ' '); // å¦‚æœæ˜¯å­—æ¯æˆ–ç©ºç™½å°±ä¿ç•™
    dbg!(my_string); // ç‚ºäº†å¥½ç©é€™æ¬¡è®“æˆ‘å€‘ç”¨ dbg!() è€Œä¸æ˜¯ println!
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">[src\main.rs:4] my_string = &quot;Age  Height  Weight &quot;
</code></pre>
<h3 id="osstring-å’Œ-cstring"><a class="header" href="#osstring-å’Œ-cstring">OsString å’Œ CString</a></h3>
<p><code>std::ffi</code> æ˜¯ <code>std</code> çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒå¹«åŠ©ä½ å°‡ Rust èˆ‡å…¶ä»–ç¨‹å¼è¨­è¨ˆèªè¨€æˆ–ä½œæ¥­ç³»çµ±ä¸€èµ·ä½¿ç”¨ã€‚å®ƒæœ‰ <code>OsString</code> å’Œ <code>CString</code> é€™æ¨£çš„å‹åˆ¥ï¼Œå®ƒå€‘å°±åƒçµ¦ä½œæ¥­ç³»çµ±ç”¨çš„ <code>String</code> æˆ–çµ¦ C èªè¨€ç”¨çš„ <code>String</code> ä¸€æ¨£ï¼Œå®ƒå€‘å„è‡ªä¹Ÿæœ‰è‡ªå·±çš„ <code>&amp;str</code> å‹åˆ¥ï¼š<code>OsStr</code> å’Œ <code>CStr</code>ã€‚<code>ffi</code> çš„æ„æ€æ˜¯&quot;å¤–éƒ¨å‡½å¼ä»‹é¢&quot;(foreign function interface)ã€‚</p>
<p>ç•¶ä½ å¿…é ˆèˆ‡æ²’æœ‰ Unicode çš„ä½œæ¥­ç³»çµ±äº’å‹•æ™‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>OsString</code>ã€‚Rust æ‰€æœ‰çš„å­—ä¸²éƒ½æ˜¯ unicodeï¼Œä½†ä¸æ˜¯æ¯å€‹ä½œæ¥­ç³»çµ±æ”¯æ´ã€‚é€™äº›æ˜¯æ¨™æº–å‡½å¼åº«ä¸­é—œæ–¼ç‚ºä»€éº¼æˆ‘å€‘æœƒæœ‰ <code>OsString</code> çš„ç°¡å–®è§£é‡‹ã€‚</p>
<ul>
<li>Unix (Linux ç­‰ç­‰)ä¸Šçš„å­—ä¸²å¯èƒ½æ˜¯å¾ˆå¤šæ²’æœ‰é›¶çš„ä½å…ƒçµ„çµ„åˆåœ¨ä¸€èµ·ã€‚è€Œä¸”æœ‰æ™‚ä½ æœƒæŠŠå®ƒå€‘è®€å–ç‚º Unicode UTF-8ã€‚</li>
<li>Windows ä¸Šçš„å­—ä¸²å¯èƒ½æ˜¯ç”±éš¨æ©Ÿçš„æ²’æœ‰é›¶çš„ 16 ä½å…ƒå€¼çµ„æˆã€‚æœ‰æ™‚ä½ æœƒæŠŠå®ƒå€‘è®€å–ç‚º Unicode UTF-16ã€‚</li>
<li>åœ¨ Rust ä¸­ï¼Œå­—ä¸²ç¸½æ˜¯æœ‰æ•ˆçš„ UTF-8ï¼Œå…¶ä¸­å¯èƒ½åŒ…å«å¤šå€‹é›¶ã€‚</li>
</ul>
<p>æ‰€ä»¥ <code>OsString</code> è¢«è¨­è¨ˆç‚ºå¯ä»¥è¢«å®ƒå€‘å…¨éƒ¨è®€å–åˆ°ã€‚</p>
<p>ä½ å¯ä»¥ç”¨ <code>OsString</code> ä¾†åšæ‰€æœ‰å¸¸è¦çš„äº‹æƒ…ï¼Œæ¯”å¦‚ <code>OsString::from(&quot;Write something here&quot;)</code>ã€‚å®ƒé‚„æœ‰å€‹æœ‰è¶£çš„æ–¹æ³•å«åš <code>.into_string()</code>ï¼Œé‚£æœƒè©¦åœ–æŠŠè‡ªå·±è®Šæˆå¸¸è¦çš„ <code>String</code>ã€‚å®ƒæœƒå›å‚³ <code>Result</code>ï¼Œä½† <code>Err</code> éƒ¨åˆ†åªæ˜¯åŸä¾†çš„ <code>OsString</code>ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ğŸš§
pub fn into_string(self) -&gt; Result&lt;String, OsString&gt;
<span class="boring">}</span></code></pre></pre>
<p>æ‰€ä»¥å¦‚æœä¸è¡Œç”¨çš„è©±ï¼Œé‚£ä½ å°±æŠŠå®ƒæ‹¿å›ä¾†ã€‚ä½ ä¸èƒ½å‘¼å« <code>.unwrap()</code>ï¼Œå› ç‚ºå®ƒæœƒææ…Œï¼Œä½†æ˜¯ä½ å¯ä»¥ä½¿ç”¨ <code>match</code> ä¾†æ‹¿å› <code>OsString</code>ã€‚è®“æˆ‘å€‘é€éå‘¼å«ä¸å­˜åœ¨çš„æ–¹æ³•ä¾†æ¸¬è©¦ä¸€ä¸‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::ffi::OsString;

fn main() {
    // âš ï¸
    let os_string = OsString::from(&quot;This string works for your OS too.&quot;);
    match os_string.into_string() {
        Ok(valid) =&gt; valid.thth(),           // ç·¨è­¯å™¨: &quot;ä»€éº¼æ˜¯ .thth()??&quot;
        Err(not_valid) =&gt; not_valid.occg(),  // ç·¨è­¯å™¨: &quot;ä»€éº¼æ˜¯ .occg()??&quot;
    }
}</code></pre></pre>
<p>ç„¶å¾Œç·¨è­¯å™¨æº–ç¢ºåœ°å‘Šè¨´æˆ‘å€‘ä»€éº¼æ˜¯æˆ‘å€‘æƒ³çŸ¥é“çš„ï¼š</p>
<pre><code class="language-text">error[E0599]: no method named `thth` found for struct `std::string::String` in the current scope
 --&gt; src/main.rs:6:28
  |
6 |         Ok(valid) =&gt; valid.thth(),
  |                            ^^^^ method not found in `std::string::String`

error[E0599]: no method named `occg` found for struct `std::ffi::OsString` in the current scope
 --&gt; src/main.rs:7:37
  |
7 |         Err(not_valid) =&gt; not_valid.occg(),
  |                                     ^^^^ method not found in `std::ffi::OsString`
</code></pre>
<p>æˆ‘å€‘å¯ä»¥çœ‹åˆ° <code>valid</code> çš„å‹åˆ¥æ˜¯ <code>String</code> ä»¥åŠ <code>not_valid</code> çš„å‹åˆ¥æ˜¯ <code>OsString</code>ã€‚</p>
<h3 id="mem"><a class="header" href="#mem">mem</a></h3>
<p><code>std::mem</code> æœ‰ä¸€äº›éå¸¸æœ‰è¶£çš„æ–¹æ³•ã€‚æˆ‘å€‘å·²ç¶“çœ‹åˆ°éä¸€äº›äº†ï¼Œæ¯”å¦‚ <code>.size_of()</code>ã€<code>.size_of_val()</code> å’Œ <code>.drop()</code>ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;

fn main() {
    println!(&quot;{}&quot;, mem::size_of::&lt;i32&gt;());
    let my_array = [8; 50];
    println!(&quot;{}&quot;, mem::size_of_val(&amp;my_array));
    let mut some_string = String::from(&quot;You can drop a String because it's on the heap&quot;);
    mem::drop(some_string);
    // some_string.clear();   å¦‚æœæˆ‘å€‘é€™æ¨£åšå°±æœƒææ…Œ
}</code></pre></pre>
<p>å°å‡ºï¼š</p>
<pre><code class="language-text">4
200
</code></pre>
<p>é€™è£¡æ˜¯ <code>mem</code> ä¸­çš„ä¸€äº›å…¶ä»–æ–¹æ³•ï¼š</p>
<p><code>swap()</code>ï¼šç”¨é€™å€‹æ–¹æ³•ä½ å¯ä»¥äº¤æ›å…©å€‹è®Šæ•¸ä¹‹é–“çš„å€¼ã€‚ä½ ç‚ºæ¯å€‹è®Šæ•¸å»ºç«‹å¯è®Šåƒè€ƒä¾†åšåˆ°é€™ä»¶äº‹ã€‚åœ¨ä½ æœ‰å…©æ¨£æ±è¥¿æƒ³äº¤æ›ï¼Œå»å› ç‚ºå€Ÿç”¨è¦å‰‡ Rust ä¸å…è¨±æ™‚å¾ˆæœ‰ç”¨ã€‚æˆ–æ˜¯ç•¶ä½ åªæƒ³å¿«é€Ÿåˆ‡æ›å…©æ¨£æ±è¥¿çš„æ™‚å€™ã€‚</p>
<p>é€™è£¡æ˜¯ä¸€å€‹ç¯„ä¾‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::{mem, fmt};

struct Ring { // å¾ Lord of the Rings å»ºç«‹æˆ’æŒ‡
    owner: String,
    former_owner: String,
    seeker: String, // æ„æ€æ˜¯ &quot;å°‹æ±‚å®ƒçš„äºº&quot;
}

impl Ring {
    fn new(owner: &amp;str, former_owner: &amp;str, seeker: &amp;str) -&gt; Self {
        Self {
            owner: owner.to_string(),
            former_owner: former_owner.to_string(),
            seeker: seeker.to_string(),
        }
    }
}

impl fmt::Display for Ring { // Display ç”¨ä¾†ç§€å‡ºèª°æ“æœ‰å®ƒåŠèª°æƒ³å¾—åˆ°å®ƒ
        fn fmt(&amp;self, f: &amp;mut fmt::Formatter&lt;'_&gt;) -&gt; fmt::Result {
            write!(f, &quot;{} has the ring, {} used to have it, and {} wants it&quot;, self.owner, self.former_owner, self.seeker)
        }
}

fn main() {
    let mut one_ring = Ring::new(&quot;Frodo&quot;, &quot;Gollum&quot;, &quot;Sauron&quot;);
    println!(&quot;{}&quot;, one_ring);
    mem::swap(&amp;mut one_ring.owner, &amp;mut one_ring.former_owner); // Gollum æ‹¿å›äº†æˆ’æŒ‡ä¸€ä¸‹å­
    println!(&quot;{}&quot;, one_ring);
}</code></pre></pre>
<p>æœƒå°å‡ºï¼š</p>
<pre><code class="language-text">Frodo has the ring, Gollum used to have it, and Sauron wants it
Gollum has the ring, Frodo used to have it, and Sauron wants it
</code></pre>
<p><code>replace()</code>ï¼šé€™åƒæ˜¯ swapï¼Œå…¶å¯¦è£¡é¢ä¹Ÿç”¨äº† swapï¼Œå¦‚åŒä½ çœ‹åˆ°çš„ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn replace&lt;T&gt;(dest: &amp;mut T, mut src: T) -&gt; T {
    swap(dest, &amp;mut src);
    src
}
<span class="boring">}</span></code></pre></pre>
<p>æ‰€ä»¥å®ƒåªæ˜¯åšäº¤æ›ï¼Œç„¶å¾Œå›å‚³å¦å¤–ä¸€å€‹ã€‚æœ‰äº†é€™å€‹ï¼Œä½ å°±èƒ½ç”¨æ”¾é€²å»çš„å…¶ä»–æ±è¥¿ä¾†æ›¿æ›å€¼ã€‚å› ç‚ºå®ƒæœƒå›å‚³èˆŠçš„å€¼ï¼Œæ‰€ä»¥ä½ æ‡‰è©²ç”¨ <code>let</code> ä¾†å–å¾—å®ƒã€‚é€™è£¡æ˜¯å€‹ä¾¿æ·çš„ç¯„ä¾‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;

struct City {
    name: String,
}

impl City {
    fn change_name(&amp;mut self, name: &amp;str) {
        let old_name = mem::replace(&amp;mut self.name, name.to_string());
        println!(
            &quot;The city once called {} is now called {}.&quot;,
            old_name, self.name
        );
    }
}

fn main() {
    let mut capital_city = City {
        name: &quot;Constantinople&quot;.to_string(),
    };
    capital_city.change_name(&quot;Istanbul&quot;);
}</code></pre></pre>
<p>å°å‡º <code>The city once called Constantinople is now called Istanbul.</code>ã€‚</p>
<p>æœ‰å€‹å‡½å¼å« <code>.take()</code>ï¼Œå’Œ <code>.replace()</code> é¡ä¼¼ï¼Œä½†å®ƒåœ¨å…ƒç´ ä¸­ç•™ä¸‹äº†é è¨­å€¼ã€‚ä½ æœƒè¨˜å¾—ï¼Œé è¨­å€¼é€šå¸¸åƒæ˜¯ 0ã€&quot;&quot; ä¹‹é¡çš„æ±è¥¿ã€‚é€™è£¡æ˜¯å®ƒçš„ç°½åï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ğŸš§
pub fn take&lt;T&gt;(dest: &amp;mut T) -&gt; T
where
    T: Default,
<span class="boring">}</span></code></pre></pre>
<p>æ‰€ä»¥ä½ å¯ä»¥åšåƒé€™æ¨£çš„äº‹æƒ…ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;

fn main() {
    let mut number_vec = vec![8, 7, 0, 2, 49, 9999];
    let mut new_vec = vec![];

    number_vec.iter_mut().for_each(|number| {
        let taker = mem::take(number);
        new_vec.push(taker);
    });

    println!(&quot;{:?}\n{:?}&quot;, number_vec, new_vec);
}</code></pre></pre>
<p>å¦‚åŒä½ çœ‹åˆ°çš„ï¼Œæ‰€æœ‰æ•¸å­—éƒ½è¢«æ›¿æ›ç‚º 0ï¼šæ²’æœ‰ä»»ä½•ç´¢å¼•çš„å…ƒç´ è¢«åˆªé™¤ã€‚</p>
<pre><code class="language-text">[0, 0, 0, 0, 0, 0]
[8, 7, 0, 2, 49, 9999]
</code></pre>
<p>å°æ–¼ä½ è‡ªå·±çš„å‹åˆ¥ï¼Œä½ ç•¶ç„¶å¯ä»¥æŠŠ <code>Default</code> å¯¦ç¾æˆä»»ä½•ä½ æƒ³è¦çš„å‹åˆ¥ã€‚è®“æˆ‘å€‘ä¾†çœ‹çœ‹æˆ‘å€‘çš„ <code>Bank</code> å’Œ <code>Robber</code> çš„ç¯„ä¾‹ã€‚æ¯æ¬¡ä»–æ¶äº† <code>Bank</code>ï¼Œä»–å°±æœƒåœ¨æ¡Œå­ä¸Šæ‹¿åˆ°éŒ¢ã€‚ä½†æ˜¯è¾¦å…¬æ¡Œå¯ä»¥éš¨æ™‚å¾å¾Œé¢æ‹¿éŒ¢ï¼Œæ‰€ä»¥å®ƒæ°¸é æœƒæœ‰ 50ã€‚æˆ‘å€‘å°‡æœƒç‚ºé€™ä»¶äº‹åšæˆ‘å€‘è‡ªå·±çš„å‹åˆ¥ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ°¸é æœƒæœ‰ 50ã€‚é€™è£¡æ˜¯å®ƒæ€éº¼åšåˆ°çš„ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::mem;
use std::ops::{Deref, DerefMut}; // æˆ‘å€‘å°‡æœƒä½¿ç”¨é€™å€‹ä¾†å¾—åˆ° u32 çš„å¨åŠ›

struct Bank {
    money_inside: u32,
    money_at_desk: DeskMoney, // é€™æ˜¯æˆ‘å€‘çš„ &quot;æ™ºæ…§æŒ‡æ¨™&quot; å‹åˆ¥. å®ƒæœ‰è‡ªå·±çš„é è¨­å€¼, ä½†ä»–æœƒä½¿ç”¨ u32
}

struct DeskMoney(u32);

impl Default for DeskMoney {
    fn default() -&gt; Self {
        Self(50) // é è¨­å€¼æ°¸é æ˜¯ 50, ä¸æ˜¯ 0
    }
}

impl Deref for DeskMoney { // æœ‰çš„é€™å€‹æˆ‘å€‘å¯ä»¥ä½¿ç”¨ * å­˜å– u32
    type Target = u32;

    fn deref(&amp;self) -&gt; &amp;Self::Target {
        &amp;self.0
    }
}

impl DerefMut for DeskMoney { // ä¸¦ä¸”æœ‰äº†é€™å€‹æˆ‘å€‘å°±å¯ä»¥åšåŠ æ¸›æ³•ç­‰ç­‰
    fn deref_mut(&amp;mut self) -&gt; &amp;mut Self::Target {
        &amp;mut self.0
    }
}

impl Bank {
    fn check_money(&amp;self) {
        println!(
            &quot;There is ${} in the back and ${} at the desk.\n&quot;,
            self.money_inside, *self.money_at_desk // è¦ç”¨ * é€™æ¨£æˆ‘å€‘æ‰èƒ½å°å‡º u32
        );
    }
}

struct Robber {
    money_in_pocket: u32,
}

impl Robber {
    fn check_money(&amp;self) {
        println!(&quot;The robber has ${} right now.\n&quot;, self.money_in_pocket);
    }

    fn rob_bank(&amp;mut self, bank: &amp;mut Bank) {
        let new_money = mem::take(&amp;mut bank.money_at_desk); // é€™è£¡æ‹¿èµ°éŒ¢, ä¸¦ç•™ä¸‹ 50 å› ç‚ºé‚£æ˜¯é è¨­å€¼
        self.money_in_pocket += *new_money; // ç”¨ * å› ç‚ºæˆ‘å€‘å¯ä»¥åªåŠ ä¸Š u32. DeskMoney ä¸èƒ½åŠ 
        bank.money_inside -= *new_money;    // é€™è£¡ä¸€æ¨£
        println!(&quot;She robbed the bank. She now has ${}!\n&quot;, self.money_in_pocket);
    }
}

fn main() {
    let mut bank_of_klezkavania = Bank { // å®‰æ’æˆ‘å€‘çš„éŠ€è¡Œ
        money_inside: 5000,
        money_at_desk: DeskMoney(50),
    };
    bank_of_klezkavania.check_money();

    let mut robber = Robber { // å®‰æ’æˆ‘å€‘çš„æ¶åŒª
        money_in_pocket: 50,
    };
    robber.check_money();

    robber.rob_bank(&amp;mut bank_of_klezkavania); // æ¶åŠ«, å†ä¾†æª¢æŸ¥é‡‘é¡
    robber.check_money();
    bank_of_klezkavania.check_money();

    robber.rob_bank(&amp;mut bank_of_klezkavania); // å†åšä¸€æ¬¡
    robber.check_money();
    bank_of_klezkavania.check_money();

}</code></pre></pre>
<p>æœƒå°å‡ºï¼š</p>
<pre><code class="language-text">There is $5000 in the back and $50 at the desk.

The robber has $50 right now.

She robbed the bank. She now has $100!

The robber has $100 right now.

There is $4950 in the back and $50 at the desk.

She robbed the bank. She now has $150!

The robber has $150 right now.

There is $4900 in the back and $50 at the desk.
</code></pre>
<p>ä½ å¯ä»¥çœ‹åˆ°æ¡Œå­ä¸Šç¸½æ˜¯æœ‰ 50 ç¾å…ƒã€‚</p>
<h3 id="prelude"><a class="header" href="#prelude">prelude</a></h3>
<p>æ¨™æº–å‡½å¼åº«ä¹Ÿæœ‰ prelude (é å…ˆè¼‰å…¥çš„å‡½å¼åº«)ï¼Œé€™å°±æ˜¯ç‚ºä»€éº¼ä½ ä¸ç”¨å¯«åƒæ˜¯ <code>use std::vec::Vec</code> çš„æ±è¥¿ä¾†å»ºç«‹ <code>Vec</code>ã€‚ä½ å¯ä»¥åœ¨<a href="https://doc.rust-lang.org/std/prelude/index.html#prelude-contents">é€™è£¡</a>çœ‹åˆ°æ‰€æœ‰é€™äº›å…ƒç´ ï¼Œä¸¦ä¸”å·²ç¶“å¤§è‡´ç­è§£ä»–å€‘ï¼š</p>
<ul>
<li><code>std::marker::{Copy, Send, Sized, Sync, Unpin}</code>ã€‚ä½ ä»¥å‰æ²’æœ‰è¦‹é <code>Unpin</code>ï¼Œå› ç‚ºå¹¾ä¹æ¯ä¸€ç¨®å‹åˆ¥éƒ½æœƒç”¨åˆ°å®ƒ(æ¯”å¦‚ <code>Sized</code>ï¼Œä¹Ÿå¾ˆå¸¸è¦‹)ã€‚&quot;Pin&quot; çš„æ„æ€æ˜¯é‡˜ä½ä¸è®“æ±è¥¿å‹•ã€‚åœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œ<code>Pin</code> æ„å‘³è‘—å®ƒä¸èƒ½åœ¨è¨˜æ†¶é«”ä¸­ç§»å‹•ï¼Œä½†å¤§å¤šæ•¸éƒ½æœ‰ <code>Unpin</code>ï¼Œæ‰€ä»¥å¯ä»¥ç§»å‹•ã€‚é€™å°±æ˜¯ç‚ºä»€éº¼åƒ <code>std::mem::replace</code> é€™æ¨£çš„å‡½å¼èƒ½ç”¨ï¼Œå› ç‚ºå®ƒå€‘æ²’æœ‰è¢«é‡˜ä½ã€‚</li>
<li><code>std::ops::{Drop, Fn, FnMut, FnOnce}</code>ã€‚</li>
<li><code>std::mem::drop</code>ã€‚</li>
<li><code>std::boxed::Box</code>ã€‚</li>
<li><code>std::borrow::ToOwned</code>ã€‚ä½ ä¹‹å‰åœ¨ <code>Cow</code> æœ‰çœ‹åˆ°éä¸€äº›ï¼Œå®ƒå¯ä»¥æŠŠå…§å®¹å¾å€Ÿä¾†çš„è®Šæˆæ“æœ‰æ‰€æœ‰æ¬Šçš„ã€‚å®ƒä½¿ç”¨ <code>.to_owned()</code> ä¾†åšåˆ°é€™ä»¶äº‹ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>.to_owned()</code> åœ¨ <code>&amp;str</code> ä¸Šä¾†å¾—åˆ° <code>String</code>ï¼Œå°æ–¼å…¶å®ƒçš„å€Ÿä¾†å€¼ç”¨æ³•ä¹Ÿä¸€æ¨£ã€‚</li>
<li><code>std::clone::Clone</code>ã€‚</li>
<li><code>std::cmp::{PartialEq, PartialOrd, Eq, Ord}</code>ã€‚</li>
<li><code>std::convert::{AsRef, AsMut, Into, From}</code>ã€‚</li>
<li><code>std::default::Default</code>ã€‚</li>
<li><code>std::iter::{Iterator, Extend, IntoIterator, DoubleEndedIterator, ExactSizeIterator}</code>ã€‚æˆ‘å€‘ä¹‹å‰åœ¨ç–Šä»£å™¨ç”¨é <code>.rev()</code>ï¼šå¯¦éš›ä¸Šæ˜¯åšå‡ºäº†<code>DoubleEndedIterator</code>ã€‚<code>ExactSizeIterator</code> åªæ˜¯é¡ä¼¼æ–¼ <code>0..10</code> çš„æ±è¥¿ï¼šå®ƒå·²ç¶“çŸ¥é“è‡ªå·±çš„ <code>.len()</code> æ˜¯ 10ã€‚å…¶ä»–ç–Šä»£å™¨è‚¯å®šæ˜¯ä¸çŸ¥é“å®ƒå€‘çš„é•·åº¦ã€‚</li>
<li><code>std::option::Option::{self, Some, None}</code>ã€‚</li>
<li><code>std::result::Result::{self, Ok, Err}</code>ã€‚</li>
<li><code>std::string::{String, ToString}</code>ã€‚</li>
<li><code>std::vec::Vec</code>ã€‚</li>
</ul>
<p>å¦‚æœä½ å› ç‚ºæŸäº›åŸå› ä¸æƒ³è¦æœ‰ prelude æ€éº¼è¾¦ï¼Ÿå°±åŠ ä¸Šå±¬æ€§ <code>#![no_implicit_prelude]</code>ã€‚è®“æˆ‘å€‘ä¾†è©¦ä¸€è©¦ï¼Œçœ‹ç·¨è­¯å™¨æŠ±æ€¨ä»€éº¼ï¼š</p>
<pre><pre class="playground"><code class="language-rust">// âš ï¸
#![no_implicit_prelude]
fn main() {
    let my_vec = vec![8, 9, 10];
    let my_string = String::from(&quot;This won't work&quot;);
    println!(&quot;{:?}, {}&quot;, my_vec, my_string);
}</code></pre></pre>
<p>ç¾åœ¨ Rust æ ¹æœ¬ä¸çŸ¥é“ä½ åœ¨å˜—è©¦åšä»€éº¼ï¼š</p>
<pre><code class="language-text">error: cannot find macro `println` in this scope
 --&gt; src/main.rs:5:5
  |
5 |     println!(&quot;{:?}, {}&quot;, my_vec, my_string);
  |     ^^^^^^^

error: cannot find macro `vec` in this scope
 --&gt; src/main.rs:3:18
  |
3 |     let my_vec = vec![8, 9, 10];
  |                  ^^^

error[E0433]: failed to resolve: use of undeclared type or module `String`
 --&gt; src/main.rs:4:21
  |
4 |     let my_string = String::from(&quot;This won't work&quot;);
  |                     ^^^^^^ use of undeclared type or module `String`

error: aborting due to 3 previous errors
</code></pre>
<p>å› æ­¤å°æ–¼é€™å€‹ç°¡å–®çš„ç¨‹å¼ç¢¼ï¼Œä½ éœ€è¦å‘Šè¨´ Rust å»ä½¿ç”¨å«åš <code>std</code> çš„ <code>extern</code> (å¤–éƒ¨) crateï¼Œä»¥åŠä½ æƒ³è¦ç”¨çš„å…ƒç´ ã€‚é€™è£¡æ˜¯ä¸€åˆ‡æˆ‘å€‘æ‰€éœ€è¦åšçš„äº‹ï¼Œåªæ˜¯ç‚ºäº†å»ºç«‹ Vec å’Œ String ä¸¦å°å‡ºå®ƒï¼š</p>
<pre><pre class="playground"><code class="language-rust">#![no_implicit_prelude]

extern crate std; // ç¾åœ¨ä½ éœ€è¦å‘Šè¨´ Rust ä½ æƒ³è¦ç”¨å«åš std çš„ crate
use std::vec; // æˆ‘å€‘éœ€è¦ vec å·¨é›†
use std::string::String; // é‚„æœ‰ String
use std::convert::From; // å’Œé€™å€‹ä¾†è½‰æ› &amp;str åˆ° String
use std::println; // é‚„æœ‰é€™å€‹ä¾†åˆ—å°

fn main() {
    let my_vec = vec![8, 9, 10];
    let my_string = String::from(&quot;This won't work&quot;);
    println!(&quot;{:?}, {}&quot;, my_vec, my_string);
}</code></pre></pre>
<p>ç¾åœ¨çµ‚æ–¼æˆåŠŸå°å‡º <code>[8, 9, 10], This won't work</code>ã€‚æ‰€ä»¥ä½ å¯ä»¥æ˜ç™½ç‚ºä»€éº¼ Rust è¦ç”¨ prelude äº†ã€‚ä½†å¦‚æœä½ é¡˜æ„ï¼Œä½ ä¸éœ€è¦ä½¿ç”¨å®ƒã€‚è€Œä¸”ä½ ç”šè‡³å¯ä»¥ä½¿ç”¨ <code>#![no_std]</code> (æˆ‘å€‘æ›¾ç¶“çœ‹éä¸€æ¬¡)ï¼Œç”¨åœ¨ä½ é€£å †ç–Šè¨˜æ†¶é«”é€™ç¨®æ±è¥¿éƒ½ç„¡æ³•ä½¿ç”¨çš„æ™‚å€™ã€‚ä½†å¤§å¤šæ•¸æ™‚å€™ï¼Œä½ æ ¹æœ¬ä¸ç”¨è€ƒæ…®æ˜¯å¦ä¸ç”¨ prelude æˆ– <code>std</code>ã€‚</p>
<p>é‚£ç‚ºä»€éº¼ä¹‹å‰æˆ‘å€‘æ²’æœ‰çœ‹é <code>extern</code> é€™å€‹é—œéµå­—å‘¢ï¼Ÿæ˜¯å› ç‚ºä½ å·²ç¶“ä¸å†é‚£éº¼éœ€è¦å®ƒäº†ã€‚ä»¥å‰åœ¨å¼•é€²å¤–éƒ¨ crate æ™‚ï¼Œä½ å¿…é ˆä½¿ç”¨å®ƒã€‚æ‰€ä»¥éå»è¦ç”¨ <code>rand</code>ï¼Œä½ å¿…é ˆè¦å¯«æˆï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>extern crate rand;
<span class="boring">}</span></code></pre></pre>
<p>ç„¶å¾Œç”¨ <code>use</code> é™³è¿°å¼ä¾†è¡¨ç¤ºä½ æƒ³è¦ä½¿ç”¨çš„æ¨¡çµ„ã€ç‰¹å¾µç­‰ç­‰ã€‚ä½†ç¾åœ¨ Rust ç·¨è­¯å™¨å·²ç¶“ä¸éœ€è¦é€™äº›å¹«åŠ©äº†â”€â”€ä½ åªéœ€è¦ä½¿ç”¨ <code>use</code>ï¼ŒRust å°±çŸ¥é“åœ¨å“ªè£¡å¯ä»¥æ‰¾åˆ°å®ƒã€‚æ‰€ä»¥ä½ å¹¾ä¹å†ä¹Ÿä¸éœ€è¦ <code>extern crate</code> äº†ï¼Œä½†åœ¨å…¶ä»–äººçš„ Rust ç¨‹å¼ç¢¼ä¸­ï¼Œä½ å¯èƒ½ä»ç„¶æœƒåœ¨é ‚éƒ¨çœ‹å¾—åˆ°å®ƒã€‚</p>
<h3 id="æ™‚é–“"><a class="header" href="#æ™‚é–“">æ™‚é–“</a></h3>
<p><code>std::time</code> æ˜¯ä½ å¯ä»¥æ‰¾åˆ°æ™‚é–“ç›¸é—œå‡½å¼çš„åœ°æ–¹ã€‚(å¦‚æœä½ æƒ³è¦æ›´å¤šçš„åŠŸèƒ½ï¼Œæœ‰ <code>chrono</code> é€™æ¨£çš„ crate å¯ä»¥ç”¨ã€‚) æœ€ç°¡å–®çš„åŠŸèƒ½å°±æ˜¯ç”¨<code>Instant::now()</code> å–å¾—ç³»çµ±æ™‚é–“ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn main() {
    let time = Instant::now();
    println!(&quot;{:?}&quot;, time);
}</code></pre></pre>
<p>å¦‚æœä½ å°å‡ºä¾†ï¼Œä½ æœƒå¾—åˆ°é€™æ¨£çš„æ±è¥¿ï¼š<code>Instant { tv_sec: 2738771, tv_nsec: 685628140 }</code>ã€‚é‚£è£¡è¬›çš„æ˜¯ç§’å’Œå¥ˆç§’ï¼Œä½†ç”¨è™•ä¸å¤§ã€‚æ¯”å¦‚ä½ çœ‹ 2738771 ç§’(å¯«æ–¼ 8 æœˆ)ï¼Œå°±æ˜¯31.70 å¤©ã€‚é€™å’Œæœˆä»½ã€æ—¥æ•¸æ²’æœ‰ä»»ä½•é—œä¿‚ã€‚ä½†æ˜¯ <code>Instant</code> çš„<a href="https://doc.rust-lang.org/std/time/struct.Instant.html">é é¢</a>å‘Šè¨´æˆ‘å€‘ï¼Œå®ƒå°æœ¬èº«ä¸æ‡‰è©²æœ‰ç”¨ã€‚å®ƒèªªå®ƒæ˜¯ &quot;ä¸é€æ˜çš„(Opaque)ï¼Œåªæœ‰å’Œ Duration ä¸€èµ·æ‰æœ‰ç”¨&quot;ã€‚é€™è£¡ä¸é€æ˜çš„çš„æ„æ€æ˜¯&quot;ä½ ç„¡æ³•ææ¸…æ¥š&quot;ï¼Œè€Œ Duration çš„æ„æ€æ˜¯&quot;éå»å¤šå°‘æ™‚é–“&quot;ã€‚æ‰€ä»¥å®ƒåªæœ‰åœ¨åšæ¯”è¼ƒæ™‚é–“é€™æ¨£çš„äº‹æƒ…æ™‚æ‰æœ‰ç”¨ã€‚</p>
<p>å¦‚æœä½ çœ‹é é¢å·¦å´çš„ç‰¹å¾µï¼Œå…¶ä¸­ä¸€å€‹æ˜¯ <code>Sub&lt;Instant&gt;</code>ã€‚ä¹Ÿå°±æ˜¯èªªæˆ‘å€‘å¯ä»¥ç”¨ <code>-</code> ä¾†æ¸›å»å¦ä¸€å€‹ã€‚è€Œç•¶æˆ‘å€‘é»é¸ [src] çœ‹å®ƒåšäº†ä»€éº¼æ™‚ï¼Œå®ƒèªªï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Sub&lt;Instant&gt; for Instant {
    type Output = Duration;

    fn sub(self, other: Instant) -&gt; Duration {
        self.duration_since(other)
    }
}
<span class="boring">}</span></code></pre></pre>
<p>å› æ­¤ï¼Œå®ƒéœ€è¦ <code>Instant</code>ï¼Œä¸¦ä½¿ç”¨ <code>.duration_since()</code> çµ¦å‡º <code>Duration</code>ã€‚è®“æˆ‘å€‘è©¦è‘—æŠŠå®ƒå°å‡ºä¾†ã€‚æˆ‘å€‘å°‡åšå‡ºå…©å€‹ç›´æ¥ç›¸é„°çš„ <code>Instant::now()</code>ï¼Œç„¶å¾Œå†è®“ç¨‹å¼å¿™ç¢Œä¸€ä¸‹ã€‚ç„¶å¾Œæˆ‘å€‘å†å¤šåšå‡ºä¸€å€‹ <code>Instant::now()</code>ã€‚ æœ€å¾Œæˆ‘å€‘å°‡çœ‹çœ‹èŠ±äº†å¤šé•·æ™‚é–“ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn main() {
    let time1 = Instant::now();
    let time2 = Instant::now(); // é€™å…©å€‹ç›´æ¥ç›¸é„°

    let mut new_string = String::new();
    loop {
        new_string.push('áƒ¬'); // è®“ Rust æŠŠå–¬æ²»äºå­—æ¯æ¨åˆ° String ä¸Š
        if new_string.len() &gt; 100_000 { // ç›´åˆ°å®ƒé•·é” 100,000 ä½å…ƒçµ„
            break;
        }
    }
    let time3 = Instant::now();
    println!(&quot;{:?}&quot;, time2 - time1);
    println!(&quot;{:?}&quot;, time3 - time1);
}</code></pre></pre>
<p>æœƒå°å‡ºé¡ä¼¼é€™æ¨£ï¼š</p>
<pre><code class="language-text">1.025Âµs
683.378Âµs
</code></pre>
<p>æ‰€ä»¥é€™åªæ˜¯ 1 å¾®ç§’å¤šå°ä¸Š 683 æ¯«ç§’ã€‚æˆ‘å€‘å¯ä»¥çœ‹åˆ° Rust ç¢ºå¯¦èŠ±äº†ä¸€äº›æ™‚é–“ä¾†åšã€‚</p>
<p>ç„¶è€Œæˆ‘å€‘å¯ä»¥åªç”¨ä¸€å€‹ <code>Instant</code> ä¾†åšä¸€ä»¶æœ‰è¶£çš„äº‹æƒ…ã€‚æˆ‘å€‘å¯ä»¥ç”¨ <code>format!(&quot;{:?}&quot;, Instant::now());</code> æŠŠå®ƒè½‰æ›æˆ <code>String</code>ã€‚çœ‹èµ·ä¾†åƒé€™æ¨£ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn main() {
    let time1 = format!(&quot;{:?}&quot;, Instant::now());
    println!(&quot;{}&quot;, time1);
}</code></pre></pre>
<p>é‚£æœƒå°å‡ºé¡ä¼¼ <code>Instant { tv_sec: 2740773, tv_nsec: 632821036 }</code> çš„æ±è¥¿ã€‚é‚£æ²’ä»€éº¼ç”¨ï¼Œä½†æ˜¯å¦‚æœæˆ‘å€‘ä½¿ç”¨ <code>.iter()</code> å’Œ <code>.rev()</code> ä»¥åŠ <code>.skip(2)</code>ï¼Œæˆ‘å€‘å¯ä»¥è·³éå°¾ç«¯çš„ <code>}</code> å’Œ <code> </code>ã€‚æˆ‘å€‘å¯ä»¥ç”¨å®ƒä¾†åšå‡ºéš¨æ©Ÿæ•¸ç”¢ç”Ÿå™¨ã€‚</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Instant;

fn bad_random_number(digits: usize) {
    if digits &gt; 9 {
        panic!(&quot;Random number can only be up to 9 digits&quot;);
    }
    let now = Instant::now();
    let output = format!(&quot;{:?}&quot;, now);

    output
        .chars()
        .rev()
        .skip(2)
        .take(digits)
        .for_each(|character| print!(&quot;{}&quot;, character));
    println!();
}

fn main() {
    bad_random_number(1);
    bad_random_number(1);
    bad_random_number(3);
    bad_random_number(3);
}</code></pre></pre>
<p>æœƒå°å‡ºé¡ä¼¼é€™æ¨£ï¼š</p>
<pre><code class="language-text">6
4
967
180
</code></pre>
<p>é€™å€‹å‡½å¼è¢«ç¨±ç‚º <code>bad_random_number</code>ï¼Œå› ç‚ºå®ƒä¸æ˜¯å€‹éå¸¸å¥½çš„éš¨æ©Ÿæ•¸ç”¢ç”Ÿå™¨ã€‚Rust æœ‰æ›´å¥½çš„ crateï¼Œå¯ä»¥ç”¨æ¯” <code>rand</code> æ›´å°‘çš„ç¨‹å¼ç¢¼åšå‡ºéš¨æ©Ÿæ•¸ï¼Œæ¯”å¦‚ <code>fastrand</code>ã€‚ä½†é€™æ˜¯å€‹ä½ å¦‚ä½•å¯ä»¥åˆ©ç”¨ä½ çš„æƒ³åƒåŠ›é€é <code>Instant</code> ä¾†åšä¸€äº›äº‹æƒ…çš„å¥½ç¯„ä¾‹ã€‚</p>
<p>ç•¶ä½ æœ‰å€‹åŸ·è¡Œç·’é‹ä½œæ™‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>std::thread::sleep</code> ä½¿å®ƒåœæ­¢ä¸€æ®µæ™‚é–“ã€‚ç•¶ä½ é€™æ¨£åšæ™‚ï¼Œä½ å¿…é ˆçµ¦å®ƒ durationã€‚ä½ ä¸å¿…åšå‡ºå¤šå€‹åŸ·è¡Œç·’ä¾†åšé€™ä»¶äº‹ï¼Œå› ç‚ºæ¯å€‹ç¨‹å¼è‡³å°‘é‹ä½œåœ¨ä¸€å€‹åŸ·è¡Œç·’ä¸Šã€‚ç„¶è€Œ <code>sleep</code> éœ€è¦ <code>Duration</code>ï¼Œæ‰€ä»¥å®ƒå¯ä»¥çŸ¥é“è¦ç¡å¤šä¹…ã€‚ä½ å¯ä»¥åƒé€™æ¨£é¸æ“‡å–®ä½ï¼š<code>Duration::from_millis()</code>ã€<code>Duration::from_secs</code> ç­‰ç­‰ã€‚é€™è£¡èˆ‰å€‹ä¾‹å­ï¼š</p>
<pre><pre class="playground"><code class="language-rust">use std::time::Duration;
use std::thread::sleep;

fn main() {
    let three_seconds = Duration::from_secs(3);
    println!(&quot;I must sleep now.&quot;);
    sleep(three_seconds);
    println!(&quot;Did I miss anything?&quot;);
}</code></pre></pre>
<p>åªæœƒå°å‡ºï¼š</p>
<pre><code class="language-text">I must sleep now.
Did I miss anything?
</code></pre>
<p>ä½†åŸ·è¡Œç·’åœ¨ä¸‰ç§’é˜å…§ä»€éº¼ä¹Ÿä¸åšã€‚ç•¶ä½ æœ‰å¾ˆå¤šåŸ·è¡Œç·’éœ€è¦ç¶“å¸¸å˜—è©¦ä¸€äº›äº‹æƒ…æ™‚ï¼Œæ¯”å¦‚é€£ç·šï¼Œä½ é€šå¸¸æœƒä½¿ç”¨ <code>.sleep()</code>ã€‚ä½ ä¸å¸Œæœ›åŸ·è¡Œç·’ä½¿ç”¨ä½ çš„è™•ç†å™¨åœ¨ä¸€ç§’é˜å…§å˜—è©¦åè¬æ¬¡ï¼Œè€Œä½ åªæ˜¯æƒ³è®“å®ƒæœ‰æ™‚æª¢æŸ¥ä¸€ä¸‹ã€‚æ‰€ä»¥ä½ å°±å¯ä»¥è¨­å®š <code>Duration</code>ï¼Œå®ƒå°±æœƒåœ¨æ¯æ¬¡é†’ä¾†çš„æ™‚å€™å˜—è©¦åšå®ƒçš„ä»»å‹™ã€‚</p>
<h3 id="å…¶ä»–å·¨é›†"><a class="header" href="#å…¶ä»–å·¨é›†">å…¶ä»–å·¨é›†</a></h3>
<p>è®“æˆ‘å€‘å†ä¾†çœ‹çœ‹ä¸€äº›å…¶ä»–å·¨é›†ã€‚</p>
<h4 id="unreachable"><a class="header" href="#unreachable"><code>unreachable!()</code></a></h4>
<p>é€™å€‹å·¨é›†æœ‰é»åƒ <code>todo!()</code>ï¼Œé™¤äº†å®ƒæ˜¯é‡å°ä½ æ°¸é ä¸æœƒç”¨çš„ç¨‹å¼ç¢¼ã€‚ä¹Ÿè¨±ä½ åœ¨åˆ—èˆ‰ä¸­æœ‰å€‹ <code>match</code>ï¼Œä½ çŸ¥é“å®ƒæ°¸é ä¸æœƒé¸æ“‡å…¶ä¸­çš„æŸå€‹åˆ†æ”¯ï¼Œæ‰€ä»¥ç¨‹å¼ç¢¼æ°¸é ç„¡æ³•åˆ°é”ã€‚å¦‚æœæ˜¯é€™æ¨£ï¼Œä½ å¯ä»¥å¯« <code>unreachable!()</code>ï¼Œé€™æ¨£ç·¨è­¯å™¨å°±çŸ¥é“å¯ä»¥å¿½ç•¥é€™éƒ¨åˆ†ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå‡è¨­ä½ æœ‰å€‹ç¨‹å¼ï¼Œç•¶ä½ é¸æ“‡ä¸€å€‹åœ°æ–¹å±…ä½æ™‚ï¼Œå®ƒæœƒå¯«ä¸€äº›æ±è¥¿ã€‚åœ¨çƒå…‹è˜­é™¤äº†è»Šè«¾æ¯”å¤–ï¼Œå…¶ä»–åœ°æ–¹éƒ½ä¸éŒ¯ã€‚ä½ çš„ç¨‹å¼ä¸è®“ä»»ä½•äººé¸æ“‡è»Šè«¾æ¯”ï¼Œå› ç‚ºå®ƒç¾åœ¨ä¸æ˜¯å€‹å±…ä½çš„å¥½åœ°æ–¹ã€‚ä½†æ˜¯é€™å€‹åˆ—èˆ‰æ˜¯å¾ˆæ—©ä»¥å‰åœ¨åˆ¥äººçš„ç¨‹å¼ç¢¼è£¡åšçš„ï¼Œä½ ç„¡æ³•æ›´æ”¹ã€‚æ‰€ä»¥åœ¨ <code>match</code> çš„åˆ†æ”¯ä¸­ï¼Œä½ å¯ä»¥åœ¨é€™è£¡ç”¨é€™å€‹å·¨é›†ã€‚çœ‹èµ·ä¾†åƒé€™æ¨£ï¼š</p>
<pre><pre class="playground"><code class="language-rust">enum UkrainePlaces {
    Kiev,
    Kharkiv,
    Chernobyl, // å‡è£æˆ‘å€‘ä¸èƒ½æ”¹è®Šåˆ—èˆ‰ - è»Šè«¾æ¯”æœƒæ°¸é åœ¨é€™
    Odesa,
    Dnipro,
}

fn choose_city(place: &amp;UkrainePlaces) {
    use UkrainePlaces::*;
    match place {
        Kiev =&gt; println!(&quot;You will live in Kiev&quot;),
        Kharkiv =&gt; println!(&quot;You will live in Kharkiv&quot;),
        Chernobyl =&gt; unreachable!(),
        Odesa =&gt; println!(&quot;You will live in Odesa&quot;),
        Dnipro =&gt; println!(&quot;You will live in Dnipro&quot;),
    }
}

fn main() {
    let user_input = UkrainePlaces::Kiev; // å‡è£ä½¿ç”¨è€…è¼¸å…¥æ˜¯ä¾†è‡ªä¸€äº›å…¶å®ƒå‡½ç¤º. ç„¡è«–å¦‚ä½•ä½¿ç”¨è€…ä¸èƒ½é¸æ“‡è»Šè«¾æ¯”
    choose_city(&amp;user_input);
}</code></pre></pre>
<p>æœƒå°å‡º <code>You will live in Kiev</code>ã€‚</p>
<p><code>unreachable!()</code> å°ä½ ä¾†èªªä¹Ÿå¾ˆå¥½è®€ï¼Œå› ç‚ºå®ƒæé†’ä½ ç¨‹å¼ç¢¼çš„æŸäº›éƒ¨åˆ†æ˜¯ä¸èƒ½åˆ°é”çš„ã€‚ä¸éä½ å¿…é ˆç¢ºå®šç¨‹å¼ç¢¼å¯¦éš›ä¸Šæ˜¯åˆ°é”ä¸äº†çš„ã€‚å¦‚æœå‘¼å«äº† <code>unreachable!()</code>ï¼Œç¨‹å¼å°±æœƒææ…Œã€‚</p>
<p>æ­¤å¤–ï¼Œå¦‚æœä½ æ›¾ç¶“æœ‰åˆ°é”ä¸äº†çš„ç¨‹å¼ç¢¼ï¼Œè€Œç·¨è­¯å™¨çŸ¥é“ï¼Œå®ƒå°±æœƒå‘Šè¨´ä½ ã€‚é€™è£¡æ˜¯å€‹ä¾¿æ·çš„ç¯„ä¾‹ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let true_or_false = true;

    match true_or_false {
        true =&gt; println!(&quot;It's true&quot;),
        false =&gt; println!(&quot;It's false&quot;),
        true =&gt; println!(&quot;It's true&quot;), // å“å‘€, æˆ‘å€‘åˆå¯«äº† true
    }
}</code></pre></pre>
<p>å®ƒæœƒèªªï¼š</p>
<pre><code class="language-text">warning: unreachable pattern
 --&gt; src/main.rs:7:9
  |
7 |         true =&gt; println!(&quot;It's true&quot;),
  |         ^^^^
  |
</code></pre>
<p>ä½†æ˜¯ <code>unreachable!()</code> æ˜¯ç”¨æ–¼ç·¨è­¯å™¨ç„¡æ³•çŸ¥é“çš„æ™‚å€™ï¼Œå°±åƒæˆ‘å€‘çš„å¦ä¸€å€‹ç¯„ä¾‹ã€‚</p>
<h4 id="columnlinefilemodule_path"><a class="header" href="#columnlinefilemodule_path"><code>column!</code>ã€<code>line!</code>ã€<code>file!</code>ã€<code>module_path!</code></a></h4>
<p>é€™å››å€‹å·¨é›†æœ‰é»åƒ <code>dbg!()</code>ï¼Œå› ç‚ºä½ åªæ˜¯æŠŠå®ƒå€‘æ”¾é€²ç¨‹å¼ç¢¼ä¾†çµ¦ä½ é™¤éŒ¯è³‡è¨Šã€‚ä½†æ˜¯å®ƒå€‘ä¸éœ€è¦æ¥å—ä»»ä½•è®Šæ•¸â€”â€”ä½ åªéœ€è¦æŠŠå®ƒå€‘å’Œæ‹¬è™Ÿä¸€èµ·ä½¿ç”¨ï¼Œè€Œä¸”æ²’æœ‰å…¶ä»–æ±è¥¿ã€‚å®ƒå€‘æ”¾åˆ°ä¸€èµ·å¾ˆå®¹æ˜“å­¸ï¼š</p>
<ul>
<li><code>column!()</code> çµ¦ä½ å¯«çš„é‚£ä¸€åˆ—</li>
<li><code>file!()</code> çµ¦ä½ å¯«çš„æª”æ¡ˆåç¨±</li>
<li><code>line!()</code> çµ¦ä½ å¯«çš„é‚£ä¸€è¡Œï¼Œç„¶å¾Œæ˜¯</li>
<li><code>module_path!()</code> çµ¦ä½ æ¨¡çµ„æ‰€åœ¨çš„ä½ç½®ã€‚</li>
</ul>
<p>æ¥ä¸‹ä¾†çš„ç¨‹å¼ç¢¼æœƒåœ¨ç°¡å–®çš„ä¾‹å­ä¸­ç§€å‡ºé€™ä¸‰è€…ã€‚æˆ‘å€‘å°‡å‡è£æœ‰æ›´å¤šçš„ç¨‹å¼ç¢¼(æ¨¡çµ„è£¡é¢çš„æ¨¡çµ„)ï¼Œå› ç‚ºé‚£å°±æ˜¯æˆ‘å€‘è¦ä½¿ç”¨é€™äº›å·¨é›†çš„åŸå› ã€‚ä½ å¯ä»¥æƒ³åƒ Rust å¤§ç¨‹å¼ï¼Œå®ƒæœ‰è¨±å¤šæ¨¡çµ„èˆ‡æª”æ¡ˆã€‚</p>
<pre><pre class="playground"><code class="language-rust">pub mod something {
    pub mod third_mod {
        pub fn print_a_country(input: &amp;mut Vec&lt;&amp;str&gt;) {
            println!(
                &quot;The last country is {} inside the module {}&quot;,
                input.pop().unwrap(),
                module_path!()
            );
        }
    }
}

fn main() {
    use something::third_mod::*;
    let mut country_vec = vec![&quot;Portugal&quot;, &quot;Czechia&quot;, &quot;Finland&quot;];
    
    // åšä¸€äº›äº‹æƒ…
    println!(&quot;Hello from file {}&quot;, file!());

    // åšä¸€äº›äº‹æƒ…
    println!(
        &quot;On line {} we got the country {}&quot;,
        line!(),
        country_vec.pop().unwrap()
    );

    // åšå¤šä¸€äº›äº‹æƒ…

    println!(
        &quot;The next country is {} on line {} and column {}.&quot;,
        country_vec.pop().unwrap(),
        line!(),
        column!(),
    );

    // å¾ˆå¤šå¾ˆå¤šçš„ç¨‹å¼ç¢¼

    print_a_country(&amp;mut country_vec);
}</code></pre></pre>
<p>å°å‡ºé€™æ¨£ï¼š</p>
<pre><code class="language-text">Hello from file src/main.rs
On line 23 we got the country Finland
The next country is Czechia on line 32 and column 9.
The last country is Portugal inside the module rust_book::something::third_mod
</code></pre>
<h4 id="cfg"><a class="header" href="#cfg"><code>cfg!</code></a></h4>
<p>æˆ‘å€‘çŸ¥é“ä½ å¯ä»¥ä½¿ç”¨ <code>#[cfg(test)]</code> å’Œ <code>#[cfg(windows)]</code> é€™æ¨£çš„å±¬æ€§ä¾†å‘Šè¨´ç·¨è­¯å™¨åœ¨æŸäº›æƒ…æ³ä¸‹è©²æ€éº¼åšã€‚ç•¶ä½ æœ‰ <code>test</code> æ™‚ï¼Œç•¶ä½ åœ¨æ¸¬è©¦æ¨¡å¼ä¸‹åŸ·è¡ŒRust æ™‚ï¼Œå®ƒæœƒåŸ·è¡Œç¨‹å¼ç¢¼(å¦‚æœæ˜¯åœ¨é›»è…¦ä¸Šï¼Œä½ è¼¸å…¥ <code>cargo test</code>)ã€‚è€Œç•¶ä½ ä½¿ç”¨ <code>windows</code> æ™‚ï¼Œå¦‚æœä½¿ç”¨è€…ä½¿ç”¨çš„æ˜¯ Windowsï¼Œå®ƒå°±æœƒåŸ·è¡Œç¨‹å¼ç¢¼ã€‚ä½†ä¹Ÿè¨±ä½ åªæ˜¯æƒ³æ ¹æ“šä¸åŒä½œæ¥­ç³»çµ±å°ä¾è³´ç³»çµ±çš„ç¨‹å¼ç¢¼åšå¾ˆå°çš„ä¿®æ”¹ã€‚é€™æ™‚å€™é€™å€‹å·¨é›†å°±å¾ˆæœ‰ç”¨äº†ã€‚å®ƒå›å‚³ <code>bool</code>ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let helpful_message = if cfg!(target_os = &quot;windows&quot;) { &quot;backslash&quot; } else { &quot;slash&quot; };

    println!(
        &quot;...then in your hard drive, type the directory name followed by a {}. Then you...&quot;,
        helpful_message
    );
}</code></pre></pre>
<p>å–æ±ºæ–¼ä½ çš„ç³»çµ±é€™å°‡ä»¥ä¸åŒçš„æ–¹å¼åˆ—å°ã€‚Rust Playground åœ¨ Linuxä¸ŠåŸ·è¡Œï¼Œæ‰€ä»¥æœƒå°å‡ºï¼š</p>
<pre><code class="language-text">...then in your hard drive, type the directory name followed by a slash. Then you...
</code></pre>
<p><code>cfg!()</code> é©ç”¨æ–¼ä»»ä½•ä¸€ç¨®é…ç½®ã€‚é€™è£¡çš„ç¯„ä¾‹æ˜¯ç•¶ä½ åœ¨æ¸¬è©¦ä¸­ä½¿ç”¨å‡½å¼æ™‚ï¼Œå®ƒçš„åŸ·è¡Œæ–¹å¼æœƒæœ‰æ‰€ä¸åŒã€‚</p>
<pre><pre class="playground"><code class="language-rust">#[cfg(test)] // cfg! æœƒçŸ¥é“è¦å°‹æ‰¾ test é€™å€‹å­—
mod testing {
    use super::*;
    #[test]
    fn check_if_five() {
        assert_eq!(bring_number(true), 5); // bring_number() å‡½å¼æ‡‰è©²å›å‚³ 5
    }
}

fn bring_number(should_run: bool) -&gt; u32 { // é€™å€‹å‡½å¼æ¥å— bool ä½œç‚ºæ˜¯å¦ä»–æ‡‰è©²åŸ·è¡Œçš„æ¢ä»¶
    if cfg!(test) &amp;&amp; should_run { // å¦‚æœå®ƒæ‡‰è©²åŸ·è¡Œä¸¦ä¸”æœ‰çµ„æ…‹æ¸¬è©¦å°±å›å‚³ 5
        5
    } else if should_run { // å¦‚æœå®ƒä¸æ˜¯ test ä½†å®ƒæ‡‰è©²åŸ·è¡Œ, å°å‡ºæŸäº›æ±è¥¿. ç•¶ä½ åŸ·è¡Œæ¸¬è©¦å®ƒæœƒå¿½ç•¥ println! é™³è¿°å¼
        println!(&quot;Returning 5. This is not a test&quot;);
        5
    } else {
        println!(&quot;This shouldn't run, returning 0.&quot;); // å¦å‰‡å›å‚³ 0
        0
    }
}

fn main() {
    bring_number(true);
    bring_number(false);
}</code></pre></pre>
<p>ç¾åœ¨æ ¹æ“šçµ„æ…‹çš„ä¸åŒï¼Œå®ƒçš„åŸ·è¡Œæ–¹å¼ä¹Ÿæœƒä¸åŒã€‚å¦‚æœä½ åªæ˜¯åŸ·è¡Œç¨‹å¼ï¼Œå®ƒæœƒçµ¦ä½ é€™æ¨£çš„çµæœï¼š</p>
<pre><code class="language-text">Returning 5. This is not a test
This shouldn't run, returning 0.
</code></pre>
<p>ä½†å¦‚æœä½ åœ¨æ¸¬è©¦æ¨¡å¼ä¸‹åŸ·è¡Œå®ƒ (<code>cargo test</code>ï¼Œç”¨ä½ é›»è…¦ä¸Šçš„ Rust è·‘)ï¼Œå®ƒå¯¦éš›ä¸ŠæœƒåŸ·è¡Œæ¸¬è©¦ã€‚å› ç‚ºåœ¨é€™ç¨®æƒ…æ³ä¸‹ï¼Œæ¸¬è©¦ç¸½æ˜¯å›å‚³ 5ï¼Œæ‰€ä»¥å®ƒæœƒé€šéã€‚</p>
<pre><code class="language-text">running 1 test
test testing::check_if_five ... ok

test result: ok. 1 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Chapter_59.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="Chapter_61.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Chapter_59.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="Chapter_61.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
